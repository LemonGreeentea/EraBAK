;콘피그 화면과 게임 설정에 관한 처리

;-------------------------------------------------
;콘피그의 초기설정
;-------------------------------------------------
@INIT_CONFIG
CONFIG:3 = 50
CONFIG:4 = 30
CONFIG:6 = 1
CONFIG:9 = 1
CONFIG:80 = 2

;SLG 부분의 콘피그의 초기설정
CALL INIT_CONFIG_SLG
;데일리 부분의 콘피그의 초기설정
CALL INIT_CONFIG_DAILY
;-------------------------------------------------
;콘피그 화면의 처리
;-------------------------------------------------
@SHOW_CONFIG
#DIM FIRST_LINE
FIRST_LINE = LINECOUNT
CALL SINGLE_DRAWLINE
PRINTL ★★각종 설정이나 데이터의 조작을 실시합니다★★
CALL SINGLE_DRAWLINE
PRINTBUTTON @"  0[%"ＳＬＧ파트에 관한 설정", 24, RIGHT%]", 0
PRINTL 
PRINTBUTTON @"  1[%"교류 파트에 관한 설정", 24, RIGHT%]", 1
PRINTL 
PRINTBUTTON @"  5[%"특수한 성벽에 관한 설정", 24, RIGHT%]", 5
PRINTL 
PRINTBUTTON @"  6[%"데일리 이벤트의 설정", 24, RIGHT%]", 6
PRINTL 
PRINTBUTTON @"  7[%"구상 데일리 필터", 24, RIGHT%]", 7
PRINTL
PRINTBUTTON @"  8[%"기존의 캐릭터의 보존", 24, RIGHT%]", 8
PRINTL
PRINTBUTTON @"  9[%"캐릭터 그림의 표시", 24, RIGHT%]", 9
PRINTL 
PRINTBUTTON @" 10[%"커맨드 필터", 24, RIGHT%]", 10
PRINTL 
PRINTL 
PRINTBUTTON @" 80[%"현재의 설정을 보존", 24, RIGHT%]", 80
PRINTL 
PRINTBUTTON @" 81[%"보존한 설정의 read", 24, RIGHT%]", 81
PRINTL 
PRINTL 
PRINTBUTTON @" 82[%"현재의 설정을 보존", 24, RIGHT%](ＳＬＧ파트 설정 제외)", 82
PRINTL 
PRINTBUTTON @" 83[%"보존한 설정의 read", 24, RIGHT%](ＳＬＧ파트 설정 제외)", 83
PRINTL 
CALL COLOR_LINE
PRINTBUTTON @" 84[%"헬프", 24, RIGHT%]", 84
PRINTL 
;[IF_DEBUG]
PRINTBUTTON @" --[%"디버그", 24, RIGHT%]", GAMEBASE_VERSION
PRINTL
;[ENDIF]
;PRINTBUTTON " 85[데이터 조작]", 85
;PRINTL 
CALL SINGLE_DRAWLINE
PRINTBUTTON @" 99[%"돌아온다", 24, RIGHT%]", 99
PRINTL 
$INPUT_LOOP
INPUT

IF RESULT == 99
	RETURN
ELSEIF RESULT == 0
	;→(SLG\CONFIG_SLG.ERB)
	CALL CONFIG_SLG
ELSEIF RESULT == 1
	CALL CONFIG_OTHERS
ELSEIF RESULT == 5
	;특수 설정
	CALL CONFIG_OTHERS_SP
ELSEIF RESULT == 6
	;이벤트 설정
	CALL CONFIG_EVENT_DAILY
ELSEIF RESULT == 7
	CALL CONFIG_KOJO_DAILY
ELSEIF RESULT == 8
	CALL CONFIG_SAVE_EXIST_CHARA
ELSEIF RESULT == 9
	CALL COMFIG_IMAGE_K
ELSEIF RESULT == 10
	CALL CONFIG_COM_FILTER
ELSEIF GROUPMATCH(RESULT, 80, 82)
	CALL CONFIG_SAVE(RESULT == 80)
ELSEIF GROUPMATCH(RESULT, 81, 83)
	CALL CONFIG_LOAD(RESULT == 81)
ELSEIF RESULT == 84
	CALL CONFIG_HELPMENU
;[IF_DEBUG]
ELSEIF RESULT == GAMEBASE_VERSION
	CALL CONFIG_DATA_EDIT
;[ENDIF]
ENDIF
CLEARLINE LINECOUNT - FIRST_LINE
RESTART

;-------------------------------------------------
;desc  :콘피그의 기입
;param :모두:전콘피그를 보존한다（지정하지 않는 경우 SLG를 제외함)
;-------------------------------------------------
@CONFIG_SAVE(모두)
#DIM 모두
#DIM 번호
CALL SINGLE_DRAWLINE
PRINTFORML 어디에 세이브합니까?
CALL SINGLE_DRAWLINE

CALL LISTUP_CONFIG

PRINTFORML [99] 돌아온다

$INPUT_LOOP
INPUT

SIF RESULT == 99
	RETURN

SIF !INRANGE(RESULT, 0, VARSIZE("G_CONFIG_NAME"))
	GOTO INPUT_LOOP

번호 = RESULT

PRINTFORML 설정 데이터의 이름을 입력해 주세요
PRINTFORML (아무것도 입력하지 않으면 「설정{번호}」가 됩니다)

$INPUT_LOOP_2
INPUTS

IF RESULTS == ""
	G_CONFIG_NAME:번호 = 설정{번호}
ELSE
	G_CONFIG_NAME:번호 = %RESULTS%
ENDIF


SIF 모두
	CALL CONFIG_SAVE_SLG(번호)

CALL CONFIG_SAVE_EXCEPT_SLG(번호)




;-------------------------------------------------
;desc  :콘피그의 독해
;param :모두:전콘피그를 읽는다
;-------------------------------------------------
@CONFIG_LOAD(모두)
#DIM 모두
#DIM 번호
CALL SINGLE_DRAWLINE
PRINTFORML 어떤 것을 로드합니까?
CALL SINGLE_DRAWLINE

CALL LISTUP_CONFIG

PRINTFORML [99] 돌아온다

$INPUT_LOOP
INPUT

SIF RESULT == 99
	RETURN

SIF !INRANGE(RESULT, 0, VARSIZE("G_CONFIG_NAME")) || !CONFIG_EXISTS()
	GOTO INPUT_LOOP

번호 = RESULT

SIF 모두
	CALL CONFIG_LOAD_SLG(번호)

CALL CONFIG_LOAD_EXCEPT_SLG(번호)

;-------------------------------------------------
;desc  :콘피그를 리스트업 해 인자한다
;-------------------------------------------------
@LISTUP_CONFIG()
FOR LOCAL, 0, VARSIZE("G_CONFIG_NAME")
	PRINTBUTTON @"[{LOCAL}] 설정{LOCAL} - %G_CONFIG_NAME:LOCAL%", LOCAL
	PRINTL
NEXT

;-------------------------------------------------
;desc  :지정 번호의 콘피그가 존재할까 돌려준다
;param :번호:콘피그 배열의 인덱스
;return:1이나 0:존재할지 어떨지
;-------------------------------------------------
@CONFIG_EXISTS(번호)
#FUNCTION
#DIM 번호
RETURNF G_CONFIG_NAME:번호 != ""

;-------------------------------------------------
;그 외의 부분에 관한 설정
;-------------------------------------------------
@CONFIG_OTHERS
#DIM FIRST_LINE
FIRST_LINE = LINECOUNT
CALL SINGLE_DRAWLINE
PRINTL ●그 외의 부분에 관한 설정●
CALL SINGLE_DRAWLINE

LOCALS:0 = 임신의 유무
PRINTFORM %LOCALS:0, 30, RIGHT% -
PRINTBUTTON "  1[변경]", 1
PRINT  
SELECTCASE CONFIG:1
	CASE 0
		PRINT 임신한다
	CASE 1
		PRINT 임신하지 않는다
ENDSELECT
PRINTL 


LOCALS:0 = 랜덤 캐릭터의 남성율
PRINTFORM %LOCALS:0, 30, RIGHT% -
PRINTBUTTON "  3[변경]", 3
PRINT  
PRINTFORM {CONFIG:3}\%
PRINTL 

LOCALS:0 = 아이의 남성율
PRINTFORM %LOCALS:0, 30, RIGHT% -
PRINTBUTTON "  4[변경]", 4
PRINT  
PRINTFORM {CONFIG:4}\%
PRINTL 


LOCALS:0 = 포로의취급 설정
PRINTFORM %LOCALS:0, 30, RIGHT% -
PRINTBUTTON "  7[변경]", 7
PRINT  
SELECTCASE CONFIG:7
	CASE 0
		PRINT 거점 페이즈 종료시에 선택
	CASE 1
		PRINT 거점 페이즈의 메뉴로부터 선택
ENDSELECT
PRINTL 

LOCALS:0 = 남자 주인공의 역조교시 경향
PRINTFORM %LOCALS:0, 30, RIGHT% -
PRINTBUTTON "  8[변경]", 8
PRINT  
SELECTCASE CONFIG:8
	CASE 0
		PRINT 짜낸다
	CASE 1
		PRINT 사정 관리
ENDSELECT
PRINTL 

LOCALS:0 = 분수의 유무
PRINTFORM %LOCALS:0, 30, RIGHT% -
PRINTBUTTON "  9[변경]", 9
PRINT  
SELECTCASE CONFIG:9
	CASE 0
		PRINT 무효
	CASE 1
		PRINT 유효
ENDSELECT
PRINTL 

LOCALS:0 = 콘돔 자동 장착＆보급
PRINTFORM %LOCALS:0, 30, RIGHT% -
PRINTBUTTON " 10[변경]", 10
PRINT  
SELECTCASE CONFIG:10
	CASE 0
		PRINT 없음
	CASE 1
		PRINT 유효（주인공 이외）
	CASE 2
		PRINT 전원
ENDSELECT
PRINTL 

LOCALS:0 = 「매춘한다」의 모브의 성별
PRINTFORM %LOCALS:0, 30, RIGHT% -
PRINTBUTTON " 14[변경]", 14
PRINT  
SELECTCASE CONFIG:14
	CASE 0
		PRINT 뿔뿔이
	CASE 1
		PRINT 남만（일부 무효）
	CASE 2
		PRINT 여만（일부 무효）
	CASE 3
		PRINT 후타나리만（일부 무효)
ENDSELECT
PRINTL 

LOCALS:0 = 「매춘한다」에서의 재야 무장
PRINTFORM %LOCALS:0, 30, RIGHT% -
PRINTBUTTON " 15[변경]", 15
PRINT  
SELECTCASE CONFIG:15
	CASE 0
		PRINT 나온다
	CASE 1
		PRINT 안나온다
ENDSELECT
PRINTL 

LOCALS:0 = 태어난 아이의 취급
PRINTFORM %LOCALS:0, 30, RIGHT% - 
PRINTBUTTON "16[변경]", 16
PRINT  
SELECTCASE CONFIG:16
	CASE 0
		PRINT 때 마다 선택
	CASE 1
		PRINT 자동으로 등용
	CASE 2
		PRINT 자동으로 비등용
ENDSELECT
PRINTL 

;
;LOCALS:0 =음모 상태의 표시
;PRINTFORM %LOCALS:0, 30, RIGHT% -
;PRINTBUTTON "15[변경]", 15
;PRINT  
;SELECTCASE CONFIG:15
;	CASE 0
;		PRINT 표시한다
;		COM_FILTER:113 = 0
;	CASE 2
;		PRINT 표시하지 않는다
;	CASE 1
;		PRINT 커맨드도 표시하지 않는다
;		COM_FILTER:113 = 1
;ENDSELECT
;PRINTL 
;
;LOCALS:0 =문신의 표시
;PRINTFORM %LOCALS:0, 30, RIGHT% -
;PRINTBUTTON "16[변경]", 16
;PRINT  
;SELECTCASE CONFIG:16
;	CASE 0
;		PRINT 표시한다
;		COM_FILTER:92 = 0
;	CASE 2
;		PRINT 표시하지 않는다
;	CASE 1
;		PRINT 커맨드도 표시하지 않는다
;		COM_FILTER:92 = 1
;ENDSELECT
;PRINTL 
;
LOCALS:0 = 포로 당신 역조교의 참가자
PRINTFORM %LOCALS:0, 30, RIGHT% -
PRINTBUTTON " 17[변경]", 17
PRINT  
SELECTCASE CONFIG:17
	CASE 0
		PRINT 전원 허가
	CASE 1
		PRINT 안면이 있는 상대만
ENDSELECT
PRINTL 

LOCALS:0 = 대상 선택 간이화
PRINTFORM %LOCALS:0, 30, RIGHT% -
PRINTBUTTON " 18[변경]", 18
PRINT  
SELECTCASE CONFIG:18
	CASE 0
		PRINT 무효
	CASE 1
		PRINT 유효
ENDSELECT
PRINTL 
PRINTL 

PRINTL 

LOCALS:0 = 고정 캐릭터의 구상의 표시
PRINTFORM %LOCALS:0, 30, RIGHT% -
PRINTBUTTON " 40[변경]", 40
PRINT  
SELECTCASE CONFIG:40
	CASE 0
		PRINT 표시한다
	CASE 1
		PRINT 표시하지 않는다
ENDSELECT
PRINTL 

LOCALS:0 = 범용 캐릭터의 구상의 표시
PRINTFORM %LOCALS:0, 30, RIGHT% -
PRINTBUTTON " 41[변경]", 41
PRINT  
SELECTCASE CONFIG:41
	CASE 0
		PRINT 표시한다
	CASE 1
		PRINT 표시하지 않는다
ENDSELECT
PRINTL 

LOCALS:0 = 조교 후 성벽 레벨 자동 상승
PRINTFORM %LOCALS:0, 30, RIGHT% -
PRINTBUTTON " 42[변경]", 42
PRINT  
SELECTCASE CONFIG:42
	CASE 0
		PRINT 하지 않는다
	CASE 1
		PRINT 한다
ENDSELECT
PRINTL 
PRINTL 


CALL SINGLE_DRAWLINE
PRINTBUTTON " 99[결정]", 99
PRINTL 

$INPUT_LOOP
INPUT

IF RESULT == 99
	RETURN
ELSEIF RESULT == 0
	CALL CONFIG_TOGGLE(0)
ELSEIF RESULT == 1
	CALL CONFIG_TOGGLE(1)
ELSEIF RESULT == 2 && CONFIG:1 == 0
	CALL CONFIG_TOGGLE(2)
ELSEIF RESULT == 3
	CONFIG:3 += 10
	IF CONFIG:3 > 100
		CONFIG:3 = 0
	ENDIF
ELSEIF RESULT == 4
	CONFIG:4 += 10
	IF CONFIG:4 > 100
		CONFIG:4 = 0
	ENDIF
ELSEIF RESULT == 7
	CALL CONFIG_TOGGLE(7)
ELSEIF RESULT == 8
	CALL CONFIG_TOGGLE(8)
ELSEIF RESULT == 9
	CALL CONFIG_TOGGLE(9)
ELSEIF RESULT == 10
	CONFIG:10 = ROUND_INCREMENT(CONFIG:10, 0, 2)
ELSEIF RESULT == 14
	CONFIG:14 = ROUND_INCREMENT(CONFIG:14, 0, 3)
ELSEIF RESULT == 15
	CALL CONFIG_TOGGLE(15)
ELSEIF RESULT == 16
	CONFIG:16 = ROUND_INCREMENT(CONFIG:16, 0, 2)
ELSEIF RESULT == 17
	SELECTCASE CONFIG:17
		CASE 0
			CONFIG:17 = 1
		CASE 1
			CONFIG:17 = 0
	ENDSELECT
ELSEIF RESULT == 18
	CALL CONFIG_TOGGLE(18)
ELSEIF RESULT == 40
	CALL CONFIG_TOGGLE(40)
ELSEIF RESULT == 41
	CALL CONFIG_TOGGLE(41)
ELSEIF RESULT == 42
	CALL CONFIG_TOGGLE(42)
ELSE
	GOTO INPUT_LOOP
ENDIF
CLEARLINE LINECOUNT - FIRST_LINE
RESTART

;-------------------------------------------------
;특수 설정(주로 좋고 싫음이 나뉘기 쉬운 요소의 설정)
;-------------------------------------------------
@CONFIG_OTHERS_SP
#DIM L_COUNTER
#DIM FIRST_LINE
#DIM CONST COM_AUTO_ADD_INPUT_NUM = 300	;맡김계의 입력치에 가산하는 값
#DIM COM_AUTO_INPUT_RESULT_NUM			;맡김계의 입력치에 가산하는 값을 감산한 값

FIRST_LINE = LINECOUNT
CALL SINGLE_DRAWLINE
PRINTL ●특수 설정●
CALL SINGLE_DRAWLINE
PRINTL ◇특수 세력◇

LOCALS:0 = 특수 세력에 의한 포로 조교 1
PRINTFORM %LOCALS:0, 40, RIGHT% -
PRINTBUTTON @"{80, 4}[변경]", 80
PRINT  
SELECTCASE CONFIG:80
	CASE 0
		PRINT 발생하지 않는다
	CASE 1
		PRINT 여성·여자 후타나리만 발생
	CASE 2
		PRINT 모두 발생
ENDSELECT
PRINTL

LOCALS:0 = 특수 세력에 의한 포로 조교 2
PRINTFORM %LOCALS:0, 40, RIGHT% -
PRINTBUTTON @"{81, 4}[변경]", 81
PRINT  
SELECTCASE CONFIG:81
	CASE 0
		PRINT 모든 특수세력
	CASE 1
		PRINT 자신이 소속된 특수세력만
	CASE 2
		PRINT 자신이 소속된 특수세력 이외
ENDSELECT
PRINTL 

LOCALS:0 = 특수 세력에 의한 포로 조교 3
PRINTFORM %LOCALS:0, 40, RIGHT% -
PRINTBUTTON @"{82, 4}[변경]", 82
PRINT  
SELECTCASE CONFIG:82
	CASE 0
		PRINT 모두
	CASE 1
		PRINT 포로만（사관을 연주한다）
	CASE 2
		PRINT 그 세력의 사관만（포로를 연주한다）
ENDSELECT
PRINTL 

CALL COLOR_LINE
PRINTL ◇스카계◇
LOCALS:0 = 절정이나 요의의 한계에 의한 실금
PRINTFORM %LOCALS:0, 40, RIGHT% -
PRINTBUTTON @"{90, 4}[변경]", 90
PRINT  
SELECTCASE CONFIG:90
	CASE 0
		PRINT 무효
	CASE 1
		PRINT 유효
ENDSELECT
PRINTL 

LOCALS:0 = 공포의 이상 상승에 의한 실금
PRINTFORM %LOCALS:0, 40, RIGHT% -
PRINTBUTTON @"{91, 4}[변경]", 91
PRINT  
SELECTCASE CONFIG:91
	CASE 0
		PRINT 무효
	CASE 1
		PRINT 유효
ENDSELECT
PRINTL 

CALL COLOR_LINE
PRINTL ◇전반◇
;LOCALS:0 =특수성버릇 이벤트 일괄 정지 필터
;PRINTFORM %LOCALS:0, 49, RIGHT% -
;PRINTBUTTON @"{ 200, 4}[변경]", 200
;PRINT  
;SELECTCASE CONFIG:200
;	CASE 0
;		PRINT 무효
;	CASE 1
;		PRINT 유효（부수 하는 능력／경험 변화도 행해지지 않습니다）
;ENDSELECT
;PRINTL 

LOCALS:0 = 남자끼리의 커맨드 필터（일부）
PRINTFORM %LOCALS:0, 40, RIGHT% -
PRINTBUTTON @"{201, 4}[변경]", 201
PRINT  
SELECTCASE CONFIG:201
	CASE 0
		PRINT 무효
	CASE 1
		PRINT 유효
ENDSELECT
PRINTL 

CALL COLOR_LINE
PRINTL ◇맡김시의 행동◇
FOR L_COUNTER, 1, COM_AUTO_FILTER_MAX + 1
	SIF COM_AUTO_FILTER_NAME(L_COUNTER) == ""
		CONTINUE
	LOCALS:0 = %COM_AUTO_FILTER_NAME(L_COUNTER)%
	PRINTFORM %LOCALS:0, 40, RIGHT% -
	PRINTBUTTON @"{L_COUNTER + COM_AUTO_ADD_INPUT_NUM, 4}[변경]", L_COUNTER + COM_AUTO_ADD_INPUT_NUM
	PRINT  
	SELECTCASE GETBIT(CONFIG:11, L_COUNTER)
		CASE 0
			PRINT 무효
		CASE 1
			PRINT 유효
	ENDSELECT
	PRINTL 
NEXT

CALL SINGLE_DRAWLINE
PRINTL [99] 결정

$INPUT_LOOP
INPUT

IF RESULT == 99
	RETURN
ELSEIF RESULT == 70
	CONFIG:70 ++
	IF CONFIG:70 >= 2
		CONFIG:70 = 0
	ENDIF
ELSEIF RESULT == 71
	CONFIG:71 ++
	IF CONFIG:71 >= 3
		CONFIG:71 = 0
	ENDIF
ELSEIF RESULT == 79 && CONFIG:71 == 2
	CONFIG:79 ++
	IF CONFIG:79 >= 3
		CONFIG:79 = 0
	ENDIF
ELSEIF RESULT == 72 && (CONFIG:70 || CONFIG:71)
	CONFIG:72 ++
	IF CONFIG:72 >= 2
		CONFIG:72 = 0
	ENDIF
ELSEIF RESULT == 73 && (CONFIG:70 || CONFIG:71)
	CONFIG:73 ++
	IF CONFIG:73 >= 2
		CONFIG:73 = 0
	ENDIF
ELSEIF RESULT == 77 && (CONFIG:70 || CONFIG:71) && CONFIG:73 == 1
	CONFIG:77 ++
	IF CONFIG:77 >= 6
		CONFIG:77 = 0
	ENDIF
ELSEIF RESULT == 78 && (CONFIG:70 || CONFIG:71) && CONFIG:73 == 1
	CONFIG:78 ++
	IF CONFIG:78 >= 2
		CONFIG:78 = 0
	ENDIF
ELSEIF RESULT == 74 && (CONFIG:70 || CONFIG:71)
	CONFIG:74 ++
	IF CONFIG:74 >= 2
		CONFIG:74 = 0
	ENDIF
ELSEIF RESULT == 75 && (CONFIG:70 || CONFIG:71)
	CONFIG:75 ++
	IF CONFIG:75 >= 2
		CONFIG:75 = 0
	ENDIF
ELSEIF RESULT == 76 && (CONFIG:70 || CONFIG:71) && CONFIG:1 == 0
	CONFIG:76 ++
	IF CONFIG:76 >= 2
		CONFIG:76 = 0
	ENDIF
ELSEIF RESULT == 80
	CONFIG:80 ++
	IF CONFIG:80 >= 3
		CONFIG:80 = 0
	ENDIF
ELSEIF RESULT == 81
	CONFIG:81 ++
	IF CONFIG:81 >= 3
		CONFIG:81 = 0
	ENDIF
ELSEIF RESULT == 82
	CONFIG:82 ++
	IF CONFIG:82 >= 3
		CONFIG:82 = 0
	ENDIF
ELSEIF RESULT == 83
	CONFIG:83 ++
	IF CONFIG:83 >= 3
		CONFIG:83 = 0
	ENDIF
ELSEIF RESULT == 84
	CONFIG:84 ++
	IF CONFIG:84 >= 3
		CONFIG:84 = 0
	ENDIF
ELSEIF RESULT == 85
	CONFIG:85 ++
	IF CONFIG:85 >= 2
		CONFIG:85 = 0
	ENDIF
ELSEIF RESULT == 86
	CONFIG:86 ++
	IF CONFIG:86 >= 3
		CONFIG:86 = 0
	ENDIF
ELSEIF RESULT == 87
	CONFIG:87 ++
	IF CONFIG:87 >= 2
		CONFIG:87 = 0
	ENDIF
ELSEIF RESULT == 90
	CONFIG:90 ++
	IF CONFIG:90 >= 2
		CONFIG:90 = 0
	ENDIF
ELSEIF RESULT == 91
	CONFIG:91 ++
	IF CONFIG:91 >= 2
		CONFIG:91 = 0
	ENDIF
;ELSEIF RESULT == 200
;	CONFIG:200 = ! CONFIG:200
ELSEIF RESULT == 201
	CONFIG:201 = !CONFIG:201
;맡김의 설정
ELSEIF RESULT >= 1 + COM_AUTO_ADD_INPUT_NUM && RESULT <= COM_AUTO_FILTER_MAX + COM_AUTO_ADD_INPUT_NUM
	COM_AUTO_INPUT_RESULT_NUM = RESULT - COM_AUTO_ADD_INPUT_NUM
	IF GETBIT(CONFIG:11, COM_AUTO_INPUT_RESULT_NUM)
		CLEARBIT CONFIG:11, COM_AUTO_INPUT_RESULT_NUM
	ELSE
		SETBIT CONFIG:11, COM_AUTO_INPUT_RESULT_NUM
	ENDIF
ELSE
	GOTO INPUT_LOOP
ENDIF
CLEARLINE LINECOUNT - FIRST_LINE
RESTART

;-------------------------------------------------
;기존의 캐릭터를 커스텀 캐릭터로서 보존한다
;-------------------------------------------------
@CONFIG_SAVE_EXIST_CHARA()
#DIM FIRST_LINE, 2
#DIM 대상
#DIM 페이지
FIRST_LINE:0 = LINECOUNT
CALL SINGLE_DRAWLINE
PRINTFORML 기존의 캐릭터를 커스텀 캐릭터로서 남길 수 있습니다
PRINTFORML (혈연 관계 따위, 일부 설정은 소거됩니다)
CALL SINGLE_DRAWLINE
CALL SELECT_CHARA_LIST_ONLY_LOGIC_SLG("NONE", "NONE")

IF RESULT == -1
	RETURN 0
ENDIF

대상 = RESULT

FIRST_LINE:1 = LINECOUNT

$LISTUP_LOOP

CALL LISTUP_CUSTOM_CHARACTER(0, 페이지, 20)
CALL SINGLE_DRAWLINE
PRINTBUTTON "[돌아온다]", 10000

INPUT

IF RESULT == 10000
	CLEARLINE LINECOUNT - FIRST_LINE
	RESTART
ELSEIF RESULT == MAX_CUSTOM_CHARA
	페이지 = ROUND_DECREMENT(페이지, 0, MAX_CUSTOM_CHARA / 20)
ELSEIF RESULT == MAX_CUSTOM_CHARA + 1
	페이지 = ROUND_INCREMENT(페이지, 0, MAX_CUSTOM_CHARA / 20)
ELSEIF INRANGE(RESULT, 0, MAX_CUSTOM_CHARA)
	LOCAL = RESULT
	IF FIND_CHARADATA(TOSTR(LOCAL))
		PRINTFORML {LOCAL}차례에는 커스텀 캐릭터가 존재합니다
		PRINTFORML 덧쓰기합니까?
		CALL ASK_YN()
		IF RESULT == 1
			CLEARLINE LINECOUNT - FIRST_LINE:1
			GOTO LISTUP_LOOP
		ENDIF
	ENDIF
	CALL SAVE_CUSTOM_DATA(LOCAL, 대상)
	PRINTFORML 세이브했습니다
	CLEARLINE LINECOUNT - FIRST_LINE
	RESTART
ENDIF

CLEARLINE LINECOUNT - FIRST_LINE:1
GOTO LISTUP_LOOP

;-------------------------------------------------
;커맨드 필터
;-------------------------------------------------
@CONFIG_COM_FILTER
#DIM FIRST_LINE
;페이지수의 계산
LOCAL:20 = 0
FOR LOCAL:0, 0, 1000
	IF TRAINNAME:(LOCAL:0) != ""
		LOCAL:20 ++
	ENDIF
NEXT
LOCAL:20 = (LOCAL:20 - 1) / 66 + 1
LOCAL:21 = 1

CALL SINGLE_DRAWLINE
PRINTFORML 너무 걸치면 역조교로 엔들레스 루프 할지도 모르기 때문에 차려라고
CALL SINGLE_DRAWLINE
FIRST_LINE = LINECOUNT
$SHOW_LOOP

;커맨드의 표시
LOCAL:22 = 0
LOCAL:23 = (LOCAL:21 - 1) * 66
LOCAL:24 = LOCAL:21 * 66
LOCAL:25 = 0
LOCAL:26 = 6
FOR LOCAL:0, 0, 1000
	IF TRAINNAME:(LOCAL:0) != ""
		IF LOCAL:22 >= LOCAL:23 && LOCAL:22 < LOCAL:24
			IF LOCAL:25 >= 1 && LOCAL:25 % 3 == 0
				PRINTL 
				LOCAL:26 ++
			ENDIF
			RESULT = 0
			TRYCALLFORM COM_FILTER_FORCE_OFF{LOCAL:0}
			IF RESULT
				SETCOLOR 칼라_파초록
				PRINTPLAINFORM [{LOCAL:0, 3}] %TRAINNAME:(LOCAL:0), 21, LEFT%
			ELSE
				IF COM_FILTER:(LOCAL:0)
					SETCOLOR 칼라_선택불가
				ENDIF
				PRINTFORM [{LOCAL:0, 3}] %TRAINNAME:(LOCAL:0), 21, LEFT%
			ENDIF
			RESETCOLOR
			LOCAL:25 ++
		ENDIF
		LOCAL:22 ++
	ENDIF
NEXT
PRINTL 
CALL SINGLE_DRAWLINE

PRINT [990] 이전페이지     
PRINTPLAINFORM page{LOCAL:21}/{LOCAL:20}    
PRINTL [991] 다음페이지


CALL SINGLE_DRAWLINE
PRINTL [999] 결정

REDRAW 0

$INPUT_LOOP
INPUT

IF RESULT == 999
	REDRAW 1
	RETURN
ELSEIF RESULT == 990
	LOCAL:21 --
	IF LOCAL:21 < 1
		LOCAL:21 = LOCAL:20
	ENDIF
	CLEARLINE LINECOUNT - FIRST_LINE
	GOTO SHOW_LOOP
ELSEIF RESULT == 991
	LOCAL:21 ++
	IF LOCAL:21 > LOCAL:20
		LOCAL:21 = 1
	ENDIF
	CLEARLINE LINECOUNT - FIRST_LINE
	GOTO SHOW_LOOP
ELSEIF RESULT >= 0 && RESULT < 1000
	LOCAL:5 = RESULT
	IF TRAINNAME:(LOCAL:5) != ""
		RESULT = 0
		TRYCALLFORM COM_FILTER_FORCE_OFF{LOCAL:5}
		IF !RESULT
			COM_FILTER:(LOCAL:5) = !COM_FILTER:(LOCAL:5)
			CLEARLINE LINECOUNT - FIRST_LINE
			GOTO SHOW_LOOP
		ENDIF
	ENDIF
ENDIF
CLEARLINE 1
GOTO INPUT_LOOP

;-------------------------------------------------
;0나 1만의 CONFIG 변환
;-------------------------------------------------
@CONFIG_TOGGLE(ARG)
	CONFIG:ARG ++
	CONFIG:ARG &= 0x1
RETURN 0
