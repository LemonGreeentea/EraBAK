;각 소스에 의한 영향의 계산

;-------------------------------------------------
;쾌Ｃ의 소스
;-------------------------------------------------
@CALC_SOURCE0(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):쾌Ｃ
LOCAL:1 = SOURCE:(ARG:0):쾌Ｃ
LOCAL:2 = SOURCE:(ARG:0):쾌Ｃ / 5
LOCAL:5 = SOURCE:(ARG:0):쾌Ｃ

LOCAL:0 = CALC_SOURCE_SENSE_BASE(ABL:(ARG:0):Ｃ감, LOCAL:0)
LOCAL:1 = CALC_SOURCE_SENSE_BASE(ABL:(ARG:0):Ｃ감, LOCAL:1)

;욕정에 의한 공통 보정
LOCAL:0 = CALC_SOURCE_SENSE_ESTRUS(ARG:0, LOCAL:0)

SELECTCASE ABL:(ARG:0):욕망
	CASE 0
		TIMES LOCAL:1, 0.10
		TIMES LOCAL:2, 1.00
	CASE 1
		TIMES LOCAL:1, 0.15
		TIMES LOCAL:2, 0.85
	CASE 2
		TIMES LOCAL:1, 0.20
		TIMES LOCAL:2, 0.70
	CASE 3
		TIMES LOCAL:1, 0.25
		TIMES LOCAL:2, 0.40
	CASE 4
		TIMES LOCAL:1, 0.30
		TIMES LOCAL:2, 0.30
	CASEELSE
		LOCAL:1 = LOCAL:1 * ((ABL:(ARG:0):욕망 - 5) * 5 + 40) / 100
		TIMES LOCAL:2, 0.10
ENDSELECT

IF TALENT:(ARG:0):Ｃ민감
	TIMES LOCAL:0, 1.5
	TIMES LOCAL:1, 2.00
	TIMES LOCAL:5, 1.50
ENDIF

IF TALENT:(ARG:0):Ｃ둔감
	TIMES LOCAL:0, 0.75
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:5, 0.75
ENDIF

IF GETBIT(TALENT:(ARG:0):음란계, 소질_음란_음핵)
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 1.20
	TIMES LOCAL:2, 0.50
	TIMES LOCAL:5, 1.50
ENDIF

;미약사용중
IF TCVAR:(ARG:0):60
	TIMES LOCAL:0, 1.5
	TIMES LOCAL:1, 1.5
	TIMES LOCAL:5, 1.50
ENDIF

;도원향 사용중
IF TFLAG:69
	TIMES LOCAL:0, 1.25
	TIMES LOCAL:1, 1.5
	TIMES LOCAL:5, 1.25
ENDIF

;체력 0에 의한 행동불능
IF TCVAR:(ARG:0):51
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:5, 0.20
ENDIF

;기력 0에 의한 실신중
IF TCVAR:(ARG:0):52
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:5, 0.20
ENDIF

;수면중
IF TCVAR:(ARG:0):53 == 1
	TIMES LOCAL:0, 0.50
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:5, 0.50
ENDIF

CUP:(ARG:0):욕정 += LOCAL:1

IF TALENT:(ARG:0):연모 && TALENT:(ARG:0):연인 && TALENT:(ARG:0):합의
	TIMES LOCAL:2, 0.25
ELSEIF (TALENT:(ARG:0):연모 || TALENT:(ARG:0):연인) && TALENT:(ARG:0):합의
	TIMES LOCAL:2, 0.50
ENDIF

IF TALENT:(ARG:0):고고함
	CUP:(ARG:0):로주 += LOCAL:2
ENDIF

IF TALENT:(ARG:0):억압 || TALENT:(ARG:0):쾌감을부정
	CUP:(ARG:0):액주 += LOCAL:2
ENDIF

IF HAS_PENIS(ARG:0)
	CUP:(ARG:0):사정 += LOCAL:5 / 5
ENDIF

CUP:(ARG:0):쾌Ｃ += LOCAL:0
CUP:(ARG:0):분수 += SQRT(LOCAL:0 * 400)

IF TALENT:(ARG:0):모유체질
	CUP:(ARG:0):분유 += CALC_SOURCE_MILK(ARG:0, LOCAL:5 / 5)
ENDIF

;-------------------------------------------------
;쾌Ｐ의 소스
;-------------------------------------------------
@CALC_SOURCE9(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):쾌Ｐ
LOCAL:1 = SOURCE:(ARG:0):쾌Ｐ
LOCAL:2 = SOURCE:(ARG:0):쾌Ｐ / 5
LOCAL:5 = SOURCE:(ARG:0):쾌Ｐ

LOCAL:0 = CALC_SOURCE_SENSE_BASE(ABL:(ARG:0):Ｃ감, LOCAL:0)
LOCAL:1 = CALC_SOURCE_SENSE_BASE(ABL:(ARG:0):Ｃ감, LOCAL:1)

;욕정에 의한 공통 보정
LOCAL:0 = CALC_SOURCE_SENSE_ESTRUS(ARG:0, LOCAL:0)

SELECTCASE ABL:(ARG:0):욕망
	CASE 0
		TIMES LOCAL:1, 0.10
		TIMES LOCAL:2, 1.00
	CASE 1
		TIMES LOCAL:1, 0.15
		TIMES LOCAL:2, 0.85
	CASE 2
		TIMES LOCAL:1, 0.20
		TIMES LOCAL:2, 0.70
	CASE 3
		TIMES LOCAL:1, 0.25
		TIMES LOCAL:2, 0.40
	CASE 4
		TIMES LOCAL:1, 0.30
		TIMES LOCAL:2, 0.30
	CASEELSE
		LOCAL:1 = LOCAL:1 * ((ABL:(ARG:0):욕망 - 5) * 5 + 40) / 100
		TIMES LOCAL:2, 0.10
ENDSELECT

IF TALENT:(ARG:0):Ｃ민감
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 2.00
	TIMES LOCAL:5, 1.50
ENDIF

IF TALENT:(ARG:0):Ｃ둔감
	TIMES LOCAL:0, 0.75
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:5, 0.75
ENDIF

IF GETBIT(TALENT:(ARG:0):음란계, 소질_음란_음핵)
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 1.20
	TIMES LOCAL:2, 0.50
	TIMES LOCAL:5, 1.50
ENDIF

;미약사용중
IF TCVAR:(ARG:0):60
	TIMES LOCAL:0, 1.5
	TIMES LOCAL:1, 1.5
	TIMES LOCAL:5, 1.50
ENDIF

;도원향 사용중
IF TFLAG:69
	TIMES LOCAL:0, 1.25
	TIMES LOCAL:1, 1.5
	TIMES LOCAL:5, 1.25
ENDIF

;체력 0에 의한 행동불능
IF TCVAR:(ARG:0):51
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:5, 0.20
ENDIF

;기력 0에 의한 실신중
IF TCVAR:(ARG:0):52
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:5, 0.20
ENDIF

;수면중
IF TCVAR:(ARG:0):53 == 1
	TIMES LOCAL:0, 0.50
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:5, 0.50
ENDIF

CUP:(ARG:0):욕정 += LOCAL:1

IF TALENT:(ARG:0):연모 || TALENT:(ARG:0):연인
	TIMES LOCAL:2, 0.50
ENDIF

IF TALENT:(ARG:0):고고함
	CUP:(ARG:0):로주 += LOCAL:2
ENDIF

IF TALENT:(ARG:0):억압 || TALENT:(ARG:0):쾌감을부정
	CUP:(ARG:0):액주 += LOCAL:2
ENDIF

IF HAS_PENIS(ARG:0)
	CUP:(ARG:0):사정 += LOCAL:5
ENDIF

CUP:(ARG:0):쾌Ｃ += LOCAL:0 / 15

IF TALENT:(ARG:0):모유체질
	CUP:(ARG:0):분유 += CALC_SOURCE_MILK(ARG:0, LOCAL:5 / 5)
ENDIF

;짐승 변화중
IF TALENT:(ARG:0):동물귀 || TALENT:(ARG:0):꼬리
	;호감도 상승
	IF LOCAL:0 >= 100000
		TCVAR:(ARG:0):10 += 2500
	ELSEIF LOCAL:0 >= 20000
		TCVAR:(ARG:0):10 += 1700
	ELSEIF LOCAL:0 >= 10000
		TCVAR:(ARG:0):10 += 1200
	ELSEIF LOCAL:0 >= 3000
		TCVAR:(ARG:0):10 += 800
	ELSEIF LOCAL:0 >= 500
		TCVAR:(ARG:0):10 += 600
	ENDIF

	;의존도 상승
	IF LOCAL:0 >= 100000
		TCVAR:(ARG:0):11 += 2500
	ELSEIF LOCAL:0 >= 20000
		TCVAR:(ARG:0):11 += 1700
	ELSEIF LOCAL:0 >= 10000
		TCVAR:(ARG:0):11 += 1200
	ELSEIF LOCAL:0 >= 3000
		TCVAR:(ARG:0):11 += 800
	ELSEIF LOCAL:0 >= 500
		TCVAR:(ARG:0):11 += 600
	ENDIF
ENDIF

;-------------------------------------------------
;쾌Ｖ의 소스
;-------------------------------------------------
@CALC_SOURCE1(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):쾌Ｖ
LOCAL:1 = SOURCE:(ARG:0):쾌Ｖ
LOCAL:2 = SOURCE:(ARG:0):쾌Ｖ / 5
LOCAL:5 = SOURCE:(ARG:0):쾌Ｖ

LOCAL:0 = CALC_SOURCE_SENSE_BASE(ABL:(ARG:0):Ｖ감, LOCAL:0)
LOCAL:1 = CALC_SOURCE_SENSE_BASE(ABL:(ARG:0):Ｖ감, LOCAL:1)

;욕정에 의한 공통 보정
LOCAL:0 = CALC_SOURCE_SENSE_ESTRUS(ARG:0, LOCAL:0)

SELECTCASE ABL:(ARG:0):욕망
	CASE 0
		TIMES LOCAL:1, 0.10
		TIMES LOCAL:2, 1.00
	CASE 1
		TIMES LOCAL:1, 0.15
		TIMES LOCAL:2, 0.85
	CASE 2
		TIMES LOCAL:1, 0.20
		TIMES LOCAL:2, 0.70
	CASE 3
		TIMES LOCAL:1, 0.25
		TIMES LOCAL:2, 0.40
	CASE 4
		TIMES LOCAL:1, 0.30
		TIMES LOCAL:2, 0.30
	CASEELSE
		LOCAL:1 = LOCAL:1 * ((ABL:(ARG:0):욕망 - 5) * 5 + 40) / 100
		TIMES LOCAL:2, 0.10
ENDSELECT

IF TALENT:(ARG:0):Ｖ민감
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 2.00
	TIMES LOCAL:5, 1.50
ENDIF

IF TALENT:(ARG:0):Ｖ둔감
	TIMES LOCAL:0, 0.75
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:5, 0.75
ENDIF

IF GETBIT(TALENT:(ARG:0):음란계, 소질_음란_음호)
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 1.50
	TIMES LOCAL:2, 0.50
	TIMES LOCAL:5, 1.50
ENDIF

;미약사용중
IF TCVAR:(ARG:0):60
	TIMES LOCAL:0, 1.5
	TIMES LOCAL:1, 1.5
	TIMES LOCAL:5, 1.50
ENDIF

;도원향 사용중
IF TFLAG:69
	TIMES LOCAL:0, 1.25
	TIMES LOCAL:1, 1.5
	TIMES LOCAL:5, 1.25
ENDIF

;체력 0에 의한 행동불능
IF TCVAR:(ARG:0):51
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:5, 0.20
ENDIF

;기력 0에 의한 실신중
IF TCVAR:(ARG:0):52
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:5, 0.20
ENDIF

;수면중
IF TCVAR:(ARG:0):53 == 1
	TIMES LOCAL:0, 0.50
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:5, 0.50
ENDIF

CUP:(ARG:0):쾌Ｖ += LOCAL:0
CUP:(ARG:0):욕정 += LOCAL:1
CUP:(ARG:0):액주 -= LOCAL:1 / 5
CUP:(ARG:0):분수 += SQRT(LOCAL:0 * 400)

SIF TALENT:(ARG:0):연모 && TALENT:(ARG:0):연인 && TALENT:(ARG:0):합의
	TIMES LOCAL:2, 0.50

SIF !TALENT:(ARG:0):처녀
	TIMES LOCAL:2, 0.50

IF TALENT:(ARG:0):고고함
	CUP:(ARG:0):로주 += LOCAL:2
ENDIF

IF TALENT:(ARG:0):억압 || TALENT:(ARG:0):쾌감을부정
	CUP:(ARG:0):액주 += LOCAL:2
ENDIF

IF TALENT:(ARG:0):처녀
	CUP:(ARG:0):포주 += LOCAL:2
ENDIF

IF HAS_PENIS(ARG:0)
	CUP:(ARG:0):사정 += LOCAL:5 / 2
ENDIF

IF TALENT:(ARG:0):모유체질
	CUP:(ARG:0):분유 += CALC_SOURCE_MILK(ARG:0, LOCAL:5 / 5)
ENDIF

;짐승 변화중
IF TALENT:(ARG:0):동물귀 || TALENT:(ARG:0):꼬리
	;호감도 상승
	IF LOCAL:0 >= 100000
		TCVAR:(ARG:0):10 += 2500
	ELSEIF LOCAL:0 >= 20000
		TCVAR:(ARG:0):10 += 1700
	ELSEIF LOCAL:0 >= 10000
		TCVAR:(ARG:0):10 += 1200
	ELSEIF LOCAL:0 >= 3000
		TCVAR:(ARG:0):10 += 800
	ELSEIF LOCAL:0 >= 500
		TCVAR:(ARG:0):10 += 600
	ENDIF

	;의존도 상승
	IF LOCAL:0 >= 100000
		TCVAR:(ARG:0):11 += 2500
	ELSEIF LOCAL:0 >= 20000
		TCVAR:(ARG:0):11 += 1700
	ELSEIF LOCAL:0 >= 10000
		TCVAR:(ARG:0):11 += 1200
	ELSEIF LOCAL:0 >= 3000
		TCVAR:(ARG:0):11 += 800
	ELSEIF LOCAL:0 >= 500
		TCVAR:(ARG:0):11 += 600
	ENDIF

	;종속도 상승
	IF LOCAL:0 >= 100000
		TCVAR:(ARG:0):12 += 1200
	ELSEIF LOCAL:0 >= 20000
		TCVAR:(ARG:0):12 += 900
	ELSEIF LOCAL:0 >= 10000
		TCVAR:(ARG:0):12 += 700
	ELSEIF LOCAL:0 >= 3000
		TCVAR:(ARG:0):12 += 500
	ELSEIF LOCAL:0 >= 500
		TCVAR:(ARG:0):12 += 300
	ENDIF

	;지배도 상승
	IF LOCAL:0 >= 100000
		TCVAR:(ARG:0):74 += 1200
	ELSEIF LOCAL:0 >= 20000
		TCVAR:(ARG:0):74 += 900
	ELSEIF LOCAL:0 >= 10000
		TCVAR:(ARG:0):74 += 700
	ELSEIF LOCAL:0 >= 3000
		TCVAR:(ARG:0):74 += 500
	ELSEIF LOCAL:0 >= 500
		TCVAR:(ARG:0):74 += 300
	ENDIF

ELSE
	;호감도 상승
	IF LOCAL:0 >= 100000
		TCVAR:(ARG:0):10 += 700
	ELSEIF LOCAL:0 >= 20000
		TCVAR:(ARG:0):10 += 500
	ELSEIF LOCAL:0 >= 10000
		TCVAR:(ARG:0):10 += 300
	ELSEIF LOCAL:0 >= 3000
		TCVAR:(ARG:0):10 += 200
	ELSEIF LOCAL:0 >= 500
		TCVAR:(ARG:0):10 += 100
	ENDIF

	;의존도 상승
	IF LOCAL:0 >= 100000
		TCVAR:(ARG:0):11 += 700
	ELSEIF LOCAL:0 >= 20000
		TCVAR:(ARG:0):11 += 500
	ELSEIF LOCAL:0 >= 10000
		TCVAR:(ARG:0):11 += 300
	ELSEIF LOCAL:0 >= 3000
		TCVAR:(ARG:0):11 += 200
	ELSEIF LOCAL:0 >= 500
		TCVAR:(ARG:0):11 += 100
	ENDIF
ENDIF

;-------------------------------------------------
;쾌Ａ의 소스
;-------------------------------------------------
@CALC_SOURCE2(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):쾌Ａ
LOCAL:1 = SOURCE:(ARG:0):쾌Ａ
LOCAL:2 = SOURCE:(ARG:0):쾌Ａ / 5
LOCAL:5 = SOURCE:(ARG:0):쾌Ａ

LOCAL:0 = CALC_SOURCE_SENSE_BASE(ABL:(ARG:0):Ａ감, LOCAL:0)
LOCAL:1 = CALC_SOURCE_SENSE_BASE(ABL:(ARG:0):Ａ감, LOCAL:1)


;욕정에 의한 공통 보정
LOCAL:0 = CALC_SOURCE_SENSE_ESTRUS(ARG:0, LOCAL:0)

SELECTCASE ABL:(ARG:0):욕망
	CASE 0
		TIMES LOCAL:1, 0.10
		TIMES LOCAL:2, 1.00
	CASE 1
		TIMES LOCAL:1, 0.15
		TIMES LOCAL:2, 0.85
	CASE 2
		TIMES LOCAL:1, 0.20
		TIMES LOCAL:2, 0.70
	CASE 3
		TIMES LOCAL:1, 0.25
		TIMES LOCAL:2, 0.40
	CASE 4
		TIMES LOCAL:1, 0.30
		TIMES LOCAL:2, 0.30
	CASEELSE
		LOCAL:1 = LOCAL:1 * ((ABL:(ARG:0):욕망 - 5) * 5 + 40) / 100
		TIMES LOCAL:2, 0.10
ENDSELECT

IF TALENT:(ARG:0):Ａ민감
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 2.00
	TIMES LOCAL:5, 1.50
ENDIF

IF TALENT:(ARG:0):Ａ둔감
	TIMES LOCAL:0, 0.75
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:5, 0.75
ENDIF

IF GETBIT(TALENT:(ARG:0):음란계, 소질_음란_항문광)
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 1.20
	TIMES LOCAL:2, 0.50
	TIMES LOCAL:5, 1.50
ENDIF

;미약사용중
IF TCVAR:(ARG:0):60
	TIMES LOCAL:0, 1.5
	TIMES LOCAL:1, 1.5
	TIMES LOCAL:5, 1.50
ENDIF

;도원향 사용중
IF TFLAG:69
	TIMES LOCAL:0, 1.25
	TIMES LOCAL:1, 1.5
	TIMES LOCAL:5, 1.25
ENDIF

;체력 0에 의한 행동불능
IF TCVAR:(ARG:0):51
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:5, 0.20
ENDIF

;기력 0에 의한 실신중
IF TCVAR:(ARG:0):52
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:5, 0.20
ENDIF

;수면중
IF TCVAR:(ARG:0):53 == 1
	TIMES LOCAL:0, 0.50
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:5, 0.50
ENDIF

CUP:(ARG:0):쾌Ａ += LOCAL:0
CUP:(ARG:0):욕정 += LOCAL:1
CUP:(ARG:0):로주 -= LOCAL:1 / 5

IF TALENT:(ARG:0):고고함
	CUP:(ARG:0):로주 += LOCAL:2
ENDIF

IF TALENT:(ARG:0):억압 || TALENT:(ARG:0):쾌감을부정
	CUP:(ARG:0):액주 += LOCAL:2
ENDIF

IF HAS_PENIS(ARG:0)
	CUP:(ARG:0):사정 += LOCAL:5 / 2
ENDIF

IF TALENT:(ARG:0):모유체질
	CUP:(ARG:0):분유 += CALC_SOURCE_MILK(ARG:0, LOCAL:5 / 5)
ENDIF

;종속도 상승
IF LOCAL:0 >= 100000
	TCVAR:(ARG:0):12 += 900
ELSEIF LOCAL:0 >= 20000
	TCVAR:(ARG:0):12 += 700
ELSEIF LOCAL:0 >= 10000
	TCVAR:(ARG:0):12 += 500
ELSEIF LOCAL:0 >= 6000
	TCVAR:(ARG:0):12 += 400
ELSEIF LOCAL:0 >= 3000
	TCVAR:(ARG:0):12 += 300
ELSEIF LOCAL:0 >= 500
	TCVAR:(ARG:0):12 += 200
ELSEIF LOCAL:0 >= 100
	TCVAR:(ARG:0):12 += 100
ENDIF

;지배도 상승
IF LOCAL:0 >= 100000
	TCVAR:(ARG:0):74 += 900
ELSEIF LOCAL:0 >= 20000
	TCVAR:(ARG:0):74 += 700
ELSEIF LOCAL:0 >= 10000
	TCVAR:(ARG:0):74 += 500
ELSEIF LOCAL:0 >= 6000
	TCVAR:(ARG:0):74 += 400
ELSEIF LOCAL:0 >= 3000
	TCVAR:(ARG:0):74 += 300
ELSEIF LOCAL:0 >= 500
	TCVAR:(ARG:0):74 += 200
ELSEIF LOCAL:0 >= 100
	TCVAR:(ARG:0):74 += 100
ENDIF

;의존도 상승
IF LOCAL:0 >= 100000
	TCVAR:(ARG:0):11 += 900
ELSEIF LOCAL:0 >= 20000
	TCVAR:(ARG:0):11 += 700
ELSEIF LOCAL:0 >= 10000
	TCVAR:(ARG:0):11 += 500
ELSEIF LOCAL:0 >= 6000
	TCVAR:(ARG:0):11 += 400
ELSEIF LOCAL:0 >= 3000
	TCVAR:(ARG:0):11 += 300
ELSEIF LOCAL:0 >= 500
	TCVAR:(ARG:0):11 += 200
ELSEIF LOCAL:0 >= 100
	TCVAR:(ARG:0):11 += 100
ENDIF

;-------------------------------------------------
;쾌Ｂ의 소스
;-------------------------------------------------
@CALC_SOURCE3(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):쾌Ｂ
LOCAL:1 = SOURCE:(ARG:0):쾌Ｂ
LOCAL:2 = SOURCE:(ARG:0):쾌Ｂ / 5
LOCAL:5 = SOURCE:(ARG:0):쾌Ｂ

LOCAL:0 = CALC_SOURCE_SENSE_BASE(ABL:(ARG:0):Ｂ감, LOCAL:0)
LOCAL:1 = CALC_SOURCE_SENSE_BASE(ABL:(ARG:0):Ｂ감, LOCAL:1)

;욕정에 의한 공통 보정
LOCAL:0 = CALC_SOURCE_SENSE_ESTRUS(ARG:0, LOCAL:0)

SELECTCASE ABL:(ARG:0):욕망
	CASE 0
		TIMES LOCAL:1, 0.10
		TIMES LOCAL:2, 1.00
	CASE 1
		TIMES LOCAL:1, 0.15
		TIMES LOCAL:2, 0.85
	CASE 2
		TIMES LOCAL:1, 0.20
		TIMES LOCAL:2, 0.70
	CASE 3
		TIMES LOCAL:1, 0.25
		TIMES LOCAL:2, 0.40
	CASE 4
		TIMES LOCAL:1, 0.30
		TIMES LOCAL:2, 0.30
	CASEELSE
		LOCAL:1 = LOCAL:1 * ((ABL:(ARG:0):욕망 - 5) * 5 + 40) / 100
		TIMES LOCAL:2, 0.10
ENDSELECT

IF TALENT:(ARG:0):Ｂ민감
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 2.00
	TIMES LOCAL:5, 1.50
ENDIF

IF TALENT:(ARG:0):Ｂ둔감
	TIMES LOCAL:0, 0.75
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:5, 0.75
ENDIF

IF GETBIT(TALENT:(ARG:0):음란계, 소질_음란_음유)
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 1.20
	TIMES LOCAL:2, 0.50
	TIMES LOCAL:5, 1.50
ENDIF

;미약사용중
IF TCVAR:(ARG:0):60
	TIMES LOCAL:0, 1.5
	TIMES LOCAL:1, 1.5
	TIMES LOCAL:5, 1.50
ENDIF

;도원향 사용중
IF TFLAG:69
	TIMES LOCAL:0, 1.25
	TIMES LOCAL:1, 1.5
	TIMES LOCAL:5, 1.25
ENDIF

;체력 0에 의한 행동불능
IF TCVAR:(ARG:0):51
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:5, 0.20
ENDIF

;기력 0에 의한 실신중
IF TCVAR:(ARG:0):52
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:5, 0.20
ENDIF

;수면중
IF TCVAR:(ARG:0):53 == 1
	TIMES LOCAL:0, 0.50
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:5, 0.50
ENDIF

CUP:(ARG:0):쾌Ｂ += LOCAL:0
CUP:(ARG:0):욕정 += LOCAL:1

IF TALENT:(ARG:0):연모 && TALENT:(ARG:0):연인
	TIMES LOCAL:2, 0.25
ELSEIF TALENT:(ARG:0):연모 || TALENT:(ARG:0):연인
	TIMES LOCAL:2, 0.50
ENDIF

SIF TALENT:(ARG:0):합의
	TIMES LOCAL:2, 0.50

IF TALENT:(ARG:0):고고함
	CUP:(ARG:0):로주 += LOCAL:2
ENDIF

IF TALENT:(ARG:0):억압 || TALENT:(ARG:0):쾌감을부정
	CUP:(ARG:0):액주 += LOCAL:2
ENDIF

IF HAS_PENIS(ARG:0)
	CUP:(ARG:0):사정 += LOCAL:5 / 5
ENDIF

IF TALENT:(ARG:0):모유체질
	CUP:(ARG:0):분유 += CALC_SOURCE_MILK(ARG:0, LOCAL:5)
ENDIF

;-------------------------------------------------
;착유의 소스
;-------------------------------------------------
@CALC_SOURCE8(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):착유
LOCAL:1 = SOURCE:(ARG:0):착유
LOCAL:2 = SOURCE:(ARG:0):착유 / 5
LOCAL:5 = SOURCE:(ARG:0):착유

LOCAL:0 = CALC_SOURCE_SENSE_BASE(ABL:(ARG:0):Ｂ감, LOCAL:0)
LOCAL:1 = CALC_SOURCE_SENSE_BASE(ABL:(ARG:0):Ｂ감, LOCAL:1)

;욕정에 의한 공통 보정
LOCAL:0 = CALC_SOURCE_SENSE_ESTRUS(ARG:0, LOCAL:0)

SELECTCASE ABL:(ARG:0):욕망
	CASE 0
		TIMES LOCAL:1, 0.10
		TIMES LOCAL:2, 1.00
	CASE 1
		TIMES LOCAL:1, 0.15
		TIMES LOCAL:2, 0.85
	CASE 2
		TIMES LOCAL:1, 0.20
		TIMES LOCAL:2, 0.70
	CASE 3
		TIMES LOCAL:1, 0.25
		TIMES LOCAL:2, 0.40
	CASE 4
		TIMES LOCAL:1, 0.30
		TIMES LOCAL:2, 0.30
	CASEELSE
		LOCAL:1 = LOCAL:1 * ((ABL:(ARG:0):욕망 - 5) * 5 + 40) / 100
		TIMES LOCAL:2, 0.10
ENDSELECT

IF TALENT:(ARG:0):Ｂ민감
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 2.00
	TIMES LOCAL:5, 1.50
ENDIF

IF TALENT:(ARG:0):Ｂ둔감
	TIMES LOCAL:0, 0.75
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:5, 0.75
ENDIF

IF GETBIT(TALENT:(ARG:0):음란계, 소질_음란_음유)
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 1.20
	TIMES LOCAL:2, 0.50
	TIMES LOCAL:5, 1.50
ENDIF

;미약사용중
IF TCVAR:(ARG:0):60
	TIMES LOCAL:0, 1.5
	TIMES LOCAL:1, 1.5
	TIMES LOCAL:5, 1.50
ENDIF

;도원향 사용중
IF TFLAG:69
	TIMES LOCAL:0, 1.25
	TIMES LOCAL:1, 1.5
	TIMES LOCAL:5, 1.25
ENDIF

;체력 0에 의한 행동불능
IF TCVAR:(ARG:0):51
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:5, 0.20
ENDIF

;기력 0에 의한 실신중
IF TCVAR:(ARG:0):52
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:5, 0.20
ENDIF

;수면중
IF TCVAR:(ARG:0):53 == 1
	TIMES LOCAL:0, 0.50
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:5, 0.50
ENDIF

CUP:(ARG:0):쾌Ｂ += LOCAL:0 / 2
CUP:(ARG:0):욕정 += LOCAL:1

IF TALENT:(ARG:0):고고함
	CUP:(ARG:0):로주 += LOCAL:2
ENDIF

IF TALENT:(ARG:0):억압 || TALENT:(ARG:0):쾌감을부정
	CUP:(ARG:0):액주 += LOCAL:2
ENDIF

IF HAS_PENIS(ARG:0)
	CUP:(ARG:0):사정 += LOCAL:5 / 10
ENDIF

IF TALENT:(ARG:0):모유체질
	CUP:(ARG:0):분유 += CALC_SOURCE_MILK(ARG:0, LOCAL:5 * 5)
ENDIF

;-------------------------------------------------
;쾌Ｍ의 소스
;-------------------------------------------------
@CALC_SOURCE4(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):쾌Ｍ
LOCAL:1 = SOURCE:(ARG:0):쾌Ｍ
LOCAL:2 = SOURCE:(ARG:0):쾌Ｍ / 5
LOCAL:5 = SOURCE:(ARG:0):쾌Ｍ

LOCAL:0 = CALC_SOURCE_SENSE_BASE(ABL:(ARG:0):Ｍ감, LOCAL:0)
LOCAL:1 = CALC_SOURCE_SENSE_BASE(ABL:(ARG:0):Ｍ감, LOCAL:1)


;욕정에 의한 공통 보정
LOCAL:0 = CALC_SOURCE_SENSE_ESTRUS(ARG:0, LOCAL:0)

SELECTCASE ABL:(ARG:0):욕망
	CASE 0
		TIMES LOCAL:1, 0.10
		TIMES LOCAL:2, 1.00
	CASE 1
		TIMES LOCAL:1, 0.15
		TIMES LOCAL:2, 0.85
	CASE 2
		TIMES LOCAL:1, 0.20
		TIMES LOCAL:2, 0.70
	CASE 3
		TIMES LOCAL:1, 0.25
		TIMES LOCAL:2, 0.40
	CASE 4
		TIMES LOCAL:1, 0.30
		TIMES LOCAL:2, 0.30
	CASEELSE
		LOCAL:1 = LOCAL:1 * ((ABL:(ARG:0):욕망 - 5) * 5 + 40) / 100
		TIMES LOCAL:2, 0.10
ENDSELECT

IF TALENT:(ARG:0):연모
	TIMES LOCAL:0, 1.20
	TIMES LOCAL:1, 1.20
	TIMES LOCAL:2, 1.20
ELSEIF TALENT:(ARG:0):친구
	TIMES LOCAL:0, 1.10
	TIMES LOCAL:1, 1.10
	TIMES LOCAL:2, 1.10
ELSEIF TALENT:(ARG:0):연인
	TIMES LOCAL:0, 1.25
	TIMES LOCAL:1, 1.25
	TIMES LOCAL:2, 1.25
ELSEIF TALENT:(ARG:0):친애
	TIMES LOCAL:0, 1.25
	TIMES LOCAL:1, 1.25
	TIMES LOCAL:2, 1.25
ELSEIF TALENT:(ARG:0):Ｍ민감
	TIMES LOCAL:0, 2.00
	TIMES LOCAL:1, 2.00
	TIMES LOCAL:5, 1.50
ELSEIF TALENT:(ARG:0):Ｍ둔감
	TIMES LOCAL:0, 0.75
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:5, 0.75
ENDIF

IF GETBIT(TALENT:(ARG:0):음란계, 소질_음란_키스마)
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 1.20
	TIMES LOCAL:2, 0.50
	TIMES LOCAL:5, 1.50
ENDIF

;미약사용중
IF TCVAR:(ARG:0):60
	TIMES LOCAL:0, 1.5
	TIMES LOCAL:1, 1.5
	TIMES LOCAL:5, 1.50
ENDIF

;도원향 사용중
IF TFLAG:69
	TIMES LOCAL:0, 1.25
	TIMES LOCAL:1, 1.5
	TIMES LOCAL:5, 1.25
ENDIF

;체력 0에 의한 행동불능
IF TCVAR:(ARG:0):51
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:5, 0.20
ENDIF

;기력 0에 의한 실신중
IF TCVAR:(ARG:0):52
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:5, 0.20
ENDIF

;수면중
IF TCVAR:(ARG:0):53 == 1
	TIMES LOCAL:0, 0.50
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:5, 0.50
ENDIF

CUP:(ARG:0):쾌Ｍ += LOCAL:0
CUP:(ARG:0):욕정 += LOCAL:1

IF TALENT:(ARG:0):연모 && TALENT:(ARG:0):연인
	TIMES LOCAL:2, 0.10
ELSEIF TALENT:(ARG:0):연모 || TALENT:(ARG:0):연인
	TIMES LOCAL:2, 0.50
ENDIF

IF TALENT:(ARG:0):고고함
	CUP:(ARG:0):로주 += LOCAL:2
ENDIF

IF TALENT:(ARG:0):억압 || TALENT:(ARG:0):쾌감을부정
	CUP:(ARG:0):액주 += LOCAL:2
ENDIF

CUP:(ARG:0):로주 -= LOCAL:1 / 3
CUP:(ARG:0):액주 -= LOCAL:1 / 3
CUP:(ARG:0):포주 -= LOCAL:1 / 3

;무드의 상승
IF LOCAL:0 >= 30000
	TFLAG:37 += 9
ELSEIF LOCAL:0 >= 10000
	TFLAG:37 += 7
ELSEIF LOCAL:0 >= 3000
	TFLAG:37 += 5
ELSEIF LOCAL:0 >= 500
	TFLAG:37 += 3
ELSEIF LOCAL:0 >= 100
	TFLAG:37 += 2
ELSEIF LOCAL:0 >= 10
	TFLAG:37 += 1
ENDIF

IF HAS_PENIS(ARG:0)
	CUP:(ARG:0):사정 += LOCAL:5 / 5
ENDIF

IF TALENT:(ARG:0):모유체질
	CUP:(ARG:0):분유 += CALC_SOURCE_MILK(ARG:0, LOCAL:5 / 5)
ENDIF

;-------------------------------------------------
;환락의 소스
;-------------------------------------------------
@CALC_SOURCE10(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):환락

IF TALENT:(ARG:0):연모 || TALENT:(ARG:0):친구
	TIMES LOCAL:0, 1.30
ENDIF

IF TALENT:(ARG:0):친애
	TIMES LOCAL:0, 1.30
ENDIF

IF TALENT:(ARG:0):연인
	TIMES LOCAL:0, 1.15
ENDIF

CUP:(ARG:0):로주 -= LOCAL:0
CUP:(ARG:0):액주 -= LOCAL:0
CUP:(ARG:0):포주 -= LOCAL:0

;호감도 상승
TCVAR:(ARG:0):10 += LOCAL:0 * 100 / 6

;무드의 상승
TFLAG:37 += LOCAL:0 / 60

;-------------------------------------------------
;애정의 소스
;-------------------------------------------------
@CALC_SOURCE11(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):애정
LOCAL:1 = SOURCE:(ARG:0):애정
LOCAL:2 = SOURCE:(ARG:0):애정

IF TALENT:(ARG:0):연모
	TIMES LOCAL:0, 1.30
	TIMES LOCAL:1, 1.25
ENDIF

IF TALENT:(ARG:0):친구
	TIMES LOCAL:0, 1.30
	TIMES LOCAL:1, 1.50
ENDIF

IF TALENT:(ARG:0):친애
	TIMES LOCAL:0, 1.30
	TIMES LOCAL:1, 2.00
ENDIF

IF TALENT:(ARG:0):연인
	TIMES LOCAL:0, 1.15
	TIMES LOCAL:1, 1.50
ENDIF

;욕망에 의한 욕정의 보정
LOCAL:1 = CALC_SOURCE_YOKUBOU(ARG:0, LOCAL:1)

;우후후중 이외
IF !FLAG:우후후플래그
	TIMES LOCAL:1, 0.20
ENDIF

CUP:(ARG:0):로주 -= LOCAL:0
CUP:(ARG:0):액주 -= LOCAL:0
CUP:(ARG:0):포주 -= LOCAL:0
CUP:(ARG:0):욕정 += LOCAL:1

;호감도 상승
TCVAR:(ARG:0):10 += LOCAL:2 * 100 / 8

;의존도 상승
TCVAR:(ARG:0):11 += LOCAL:2 * 100 / 12

;무드의 상승
TFLAG:37 += LOCAL:0 / 15

;-------------------------------------------------
;우월의 소스
;-------------------------------------------------
@CALC_SOURCE12(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):우월
LOCAL:1 = SOURCE:(ARG:0):우월
LOCAL:2 = SOURCE:(ARG:0):우월
LOCAL:3 = SOURCE:(ARG:0):우월

LOCAL:5 = ABL:(ARG:0):주도도Ｕ
IF GETBIT(TALENT:(ARG:0):음란계, 소질_음란_새드)
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 1.50
	TIMES LOCAL:2, 0.00
	TIMES LOCAL:3, 1.50
ELSEIF LOCAL:5 >= 500
	TIMES LOCAL:0, 1.00
	TIMES LOCAL:1, 1.00
	TIMES LOCAL:2, 0.00
	TIMES LOCAL:3, 1.50
ELSEIF LOCAL:5 >= 300
	TIMES LOCAL:0, 0.80
	TIMES LOCAL:1, 0.90
	TIMES LOCAL:2, 0.00
	TIMES LOCAL:3, 1.30
ELSEIF LOCAL:5 >= 100
	TIMES LOCAL:0, 0.60
	TIMES LOCAL:1, 0.70
	TIMES LOCAL:2, 0.00
	TIMES LOCAL:3, 1.10
ELSEIF LOCAL:5 < -100
	TIMES LOCAL:0, 0.30
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 0.00
	TIMES LOCAL:3, 1.00
ELSEIF LOCAL:5 < -300
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:2, 0.30
	TIMES LOCAL:3, 0.90
ELSEIF LOCAL:5 < -500
	TIMES LOCAL:0, 0.10
	TIMES LOCAL:1, 0.10
	TIMES LOCAL:2, 0.60
	TIMES LOCAL:3, 0.80
ELSE
	TIMES LOCAL:0, 0.05
	TIMES LOCAL:1, 0.05
	TIMES LOCAL:2, 1.00
	TIMES LOCAL:3, 0.70
ENDIF

;욕망에 의한 욕정의 보정
LOCAL:0 = CALC_SOURCE_YOKUBOU(ARG:0, LOCAL:0)

CUP:(ARG:0):욕정 += LOCAL:0
CUP:(ARG:0):로주 -= LOCAL:1
CUP:(ARG:0):액주 -= LOCAL:1

;호감도 상승
TCVAR:(ARG:0):10 += LOCAL:1 * 10

;의존도 상승
TCVAR:(ARG:0):11 += LOCAL:1 * 10 / 3

;종속도 감소
TCVAR:(ARG:0):17 += LOCAL:3 * 10 / 2

;지배도 상승
TCVAR:(ARG:0):74 += LOCAL:1 * 10 * 2 / 3


;-------------------------------------------------
;굴종의 소스
;-------------------------------------------------
@CALC_SOURCE13(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):굴종
LOCAL:1 = SOURCE:(ARG:0):굴종
LOCAL:2 = SOURCE:(ARG:0):굴종
LOCAL:3 = SOURCE:(ARG:0):굴종

LOCAL:5 = ABL:(ARG:0):주도도Ｕ
IF GETBIT(TALENT:(ARG:0):음란계, 소질_음란_마조)
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 1.50
	TIMES LOCAL:2, 0.10
	TIMES LOCAL:3, 1.50
ELSEIF LOCAL:5 <= -500
	TIMES LOCAL:0, 1.00
	TIMES LOCAL:1, 1.00
	TIMES LOCAL:2, 0.50
	TIMES LOCAL:3, 1.50
ELSEIF LOCAL:5 <= -300
	TIMES LOCAL:0, 0.60
	TIMES LOCAL:1, 0.90
	TIMES LOCAL:2, 0.60
	TIMES LOCAL:3, 1.30
ELSEIF LOCAL:5 <= -100
	TIMES LOCAL:0, 0.40
	TIMES LOCAL:1, 0.80
	TIMES LOCAL:2, 0.70
	TIMES LOCAL:3, 1.10
ELSEIF LOCAL:5 < 100
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.60
	TIMES LOCAL:2, 0.80
	TIMES LOCAL:3, 1.00
ELSEIF LOCAL:5 < 300
	TIMES LOCAL:0, 0.00
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 0.90
	TIMES LOCAL:3, 0.90
ELSEIF LOCAL:5 < 500
	TIMES LOCAL:0, 0.00
	TIMES LOCAL:1, 0.40
	TIMES LOCAL:2, 1.00
	TIMES LOCAL:3, 0.80
ELSE
	TIMES LOCAL:0, 0.00
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:2, 1.00
	TIMES LOCAL:3, 0.70
ENDIF

;욕망에 의한 욕정의 보정
LOCAL:0 = CALC_SOURCE_YOKUBOU(ARG:0, LOCAL:0)

IF TALENT:(ARG:0):복종
	TIMES LOCAL:0, 1.30
	TIMES LOCAL:1, 1.30
ENDIF
IF TALENT:(ARG:0):예속
	TIMES LOCAL:0, 1.30
	TIMES LOCAL:1, 1.30
ENDIF
IF TALENT:(ARG:0):낙인
	TIMES LOCAL:0, 1.30
	TIMES LOCAL:1, 1.30
ENDIF

CUP:(ARG:0):욕정 += LOCAL:0
CUP:(ARG:0):로주 -= LOCAL:1

IF TALENT:(ARG:0):복종 || TALENT:(ARG:0):낙인
	CUP:(ARG:0):액주 -= LOCAL:1
ENDIF

IF TALENT:(ARG:0):억압
	CUP:(ARG:0):액주 += LOCAL:2
ENDIF

;의존도 상승
TCVAR:(ARG:0):11 += LOCAL:3 * 10 / 3

;종속도 상승
TCVAR:(ARG:0):12 += LOCAL:3 * 10

;지배도 현상
TCVAR:(ARG:0):75 += LOCAL:3 * 10 / 2


;-------------------------------------------------
;공포의 소스
;-------------------------------------------------
@CALC_SOURCE14(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):공포

CUP:(ARG:0):로주 += LOCAL:0 * 3 / 10
CUP:(ARG:0):포주 += LOCAL:0

;호감도 감소
TCVAR:(ARG:0):15 += LOCAL:0

;종속도 상승
TCVAR:(ARG:0):12 += LOCAL:0
;지배도 현상
TCVAR:(ARG:0):75 += LOCAL:0 * 10 / 2


;-------------------------------------------------
;반감의 소스
;-------------------------------------------------
@CALC_SOURCE15(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):반감

CUP:(ARG:0):로주 += LOCAL:0
CUP:(ARG:0):액주 += LOCAL:0 * 3 / 10

;호감도 감소
TCVAR:(ARG:0):15 += LOCAL:0

;의존도 감소
TCVAR:(ARG:0):16 += LOCAL:0

;종속도 감소
TCVAR:(ARG:0):17 += LOCAL:0

;-------------------------------------------------
;불안의 소스
;-------------------------------------------------
@CALC_SOURCE16(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):불안

CUP:(ARG:0):로주 += LOCAL:0 * 3 / 10
CUP:(ARG:0):액주 += LOCAL:0
CUP:(ARG:0):포주 += LOCAL:0 * 7 / 10

;호감도 감소
TCVAR:(ARG:0):15 += LOCAL:0

;-------------------------------------------------
;접촉의 소스
;-------------------------------------------------
@CALC_SOURCE17(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):접촉
LOCAL:1 = SOURCE:(ARG:0):접촉
LOCAL:2 = SOURCE:(ARG:0):접촉 / 2
LOCAL:3 = SOURCE:(ARG:0):접촉 * 2 / 3

;호감도·종속도·지배도의 큰 (분)편을 본다
IF ARG:0 != MASTER

	LOCAL:5 = MAX(CFLAG:(ARG:0):2, CFLAG:(ARG:0):4, CFLAG:(ARG:0):지배도)
	IF LOCAL:5 < 100
		TIMES LOCAL:0, 0.00
		TIMES LOCAL:1, 1.20
	ELSEIF LOCAL:5 < 300
		TIMES LOCAL:0, 0.10
		TIMES LOCAL:1, 1.00
	ELSEIF LOCAL:5 < 500
		TIMES LOCAL:0, 0.30
		TIMES LOCAL:1, 0.70
	ELSEIF LOCAL:5 < 800
		TIMES LOCAL:0, 0.50
		TIMES LOCAL:1, 0.30
	ELSEIF LOCAL:5 < 1500
		TIMES LOCAL:0, 0.80
		TIMES LOCAL:1, 0.10
	ELSEIF LOCAL:5 < 3000
		TIMES LOCAL:0, 1.50
		TIMES LOCAL:1, 0.00
	ELSEIF LOCAL:5 < 5000
		TIMES LOCAL:0, 1.40
		TIMES LOCAL:1, 0.00
	ELSE
		TIMES LOCAL:0, 1.50
		TIMES LOCAL:1, 0.00
	ENDIF
ENDIF

;호감도를 본다
IF ARG:0 != MASTER
	IF CFLAG:(ARG:0):2 < 100
		TIMES LOCAL:2, 1.00
		TIMES LOCAL:3, 1.00
	ELSEIF CFLAG:(ARG:0):2 < 300
		TIMES LOCAL:2, 0.90
		TIMES LOCAL:3, 0.90
	ELSEIF CFLAG:(ARG:0):2 < 500
		TIMES LOCAL:2, 0.70
		TIMES LOCAL:3, 0.70
	ELSEIF CFLAG:(ARG:0):2 < 800
		TIMES LOCAL:2, 0.30
		TIMES LOCAL:3, 0.30
	ELSEIF CFLAG:(ARG:0):2 < 1500
		TIMES LOCAL:2, 0.15
		TIMES LOCAL:3, 0.15
	ELSE
		TIMES LOCAL:2, 0.00
		TIMES LOCAL:3, 0.00
	ENDIF
ENDIF

IF TALENT:(ARG:0):수줍음
	TIMES LOCAL:1, 1.50
	TIMES LOCAL:2, 2.00
	TIMES LOCAL:3, 2.00
ENDIF

IF TALENT:(ARG:0):수치심옅음
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 0.50
	TIMES LOCAL:3, 0.50
ENDIF

IF TALENT:(ARG:0):연모
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:2, 0.10
	TIMES LOCAL:3, 0.20
ENDIF
IF TALENT:(ARG:0):친구
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:2, 0.10
	TIMES LOCAL:3, 0.20
ENDIF
IF TALENT:(ARG:0):친애
	TIMES LOCAL:0, 2.00
	TIMES LOCAL:1, 0.00
	TIMES LOCAL:2, 0.10
	TIMES LOCAL:3, 0.20
ENDIF
IF TALENT:(ARG:0):연인
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 0.10
	TIMES LOCAL:3, 0.20
ENDIF

IF IS_MALE(ARG:0)
	TIMES LOCAL:1, 0.75
	TIMES LOCAL:2, 0.75
	TIMES LOCAL:3, 0.75
ENDIF

LOCAL:11 = 1
IF IS_MPLY(ARG:0)
	FOR LOCAL:10, 0, MTAR_NUM
		IF !IS_SAMESEX(ARG:0, MTAR:(LOCAL:10))
			LOCAL:11 = 0
			BREAK
		ENDIF
	NEXT
ELSEIF IS_MTAR(ARG:0)
	FOR LOCAL:10, 0, MPLY_NUM
		IF !IS_SAMESEX(ARG:0, MPLY:(LOCAL:10))
			LOCAL:11 = 0
			BREAK
		ENDIF
	NEXT
ENDIF
IF LOCAL:11
	IF !TALENT:(ARG:0):바이
		TIMES LOCAL:0, 0.80
	ENDIF
	TIMES LOCAL:1, 0.60
	TIMES LOCAL:2, 0.60
	TIMES LOCAL:3, 0.60
ENDIF

IF IS_SAMESEX(MASTER, ARG:0) || ABL:(ARG:0):성지식 == 0
	IF (!TALENT:(ARG:0):합의 && !FLAG:우후후플래그) || ABL:(ARG:0):성지식 == 0
		TIMES LOCAL:0, 0.30
	ENDIF
	TIMES LOCAL:1, 0.30
	TIMES LOCAL:2, 0.30
	TIMES LOCAL:3, 0.50
ENDIF

CUP:(ARG:0):욕정 += LOCAL:0
CUP:(ARG:0):로주 += LOCAL:1
CUP:(ARG:0):액주 += LOCAL:2
CUP:(ARG:0):포주 += LOCAL:3

;-------------------------------------------------
;봉사의 소스
;-------------------------------------------------
@CALC_SOURCE18(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):봉사
LOCAL:1 = SOURCE:(ARG:0):봉사
LOCAL:2 = SOURCE:(ARG:0):봉사

;욕망에 의한 욕정의 보정
LOCAL:0 = CALC_SOURCE_YOKUBOU(ARG:0, LOCAL:0)

SELECTCASE ABL:(ARG:0):봉사
	CASE 0
		TIMES LOCAL:1, 1.00
	CASE 1
		TIMES LOCAL:1, 0.80
	CASE 2
		TIMES LOCAL:1, 0.60
	CASE 3
		TIMES LOCAL:1, 0.40
	CASE 4
		TIMES LOCAL:1, 0.20
	CASEELSE
		TIMES LOCAL:1, 0.10
ENDSELECT

CUP:(ARG:0):욕정 += LOCAL:0

IF TALENT:(ARG:0):억압 || TALENT:(ARG:0):고고함
	CUP:(ARG:0):액주 += LOCAL:1
ENDIF

;-------------------------------------------------
;고통의 소스
;-------------------------------------------------
@CALC_SOURCE19(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):고통
LOCAL:1 = SOURCE:(ARG:0):고통
LOCAL:2 = SOURCE:(ARG:0):고통
LOCAL:3 = SOURCE:(ARG:0):고통
LOCAL:4 = SOURCE:(ARG:0):고통 / 5

;호감도와 종속도의 큰 (분)편을 본다
IF ARG:0 != MASTER
	LOCAL:5 = MAX(CFLAG:(ARG:0):2, CFLAG:(ARG:0):4, CFLAG:(ARG:0):지배도)
	IF LOCAL:5 < 100
		TIMES LOCAL:0, 0.50
		TIMES LOCAL:1, 2.00
		TIMES LOCAL:2, 1.00
		TIMES LOCAL:3, 2.00
	ELSEIF LOCAL:5 < 300
		TIMES LOCAL:0, 0.60
		TIMES LOCAL:1, 1.60
		TIMES LOCAL:2, 0.90
		TIMES LOCAL:3, 1.90
	ELSEIF LOCAL:5 < 500
		TIMES LOCAL:0, 0.70
		TIMES LOCAL:1, 1.30
		TIMES LOCAL:2, 0.80
		TIMES LOCAL:3, 1.80
	ELSEIF LOCAL:5 < 800
		TIMES LOCAL:0, 0.80
		TIMES LOCAL:1, 1.00
		TIMES LOCAL:2, 0.70
		TIMES LOCAL:3, 1.60
	ELSEIF LOCAL:5 < 1500
		TIMES LOCAL:0, 1.00
		TIMES LOCAL:1, 0.60
		TIMES LOCAL:2, 0.50
		TIMES LOCAL:3, 1.40
	ELSE
		TIMES LOCAL:0, 1.20
		TIMES LOCAL:1, 0.30
		TIMES LOCAL:2, 0.30
		TIMES LOCAL:3, 1.00
	ENDIF
ENDIF

;도착도를 본다
LOCAL:5 = ABL:(ARG:0):도착도
IF GETBIT(TALENT:(ARG:0):음란계, 소질_음란_마조)
	TIMES LOCAL:0, 1.20
	TIMES LOCAL:1, 0.10
	TIMES LOCAL:2, 0.10
	TIMES LOCAL:4, 0.50
ELSEIF LOCAL:5 >= 800
	TIMES LOCAL:0, 1.00
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:2, 0.20
	TIMES LOCAL:4, 0.60
ELSEIF LOCAL:5 >= 500
	TIMES LOCAL:0, 0.70
	TIMES LOCAL:1, 0.40
	TIMES LOCAL:2, 0.40
	TIMES LOCAL:4, 0.70
ELSEIF LOCAL:5 >= 300
	TIMES LOCAL:0, 0.30
	TIMES LOCAL:1, 0.60
	TIMES LOCAL:2, 0.60
	TIMES LOCAL:4, 0.80
ELSEIF LOCAL:5 >= 100
	TIMES LOCAL:0, 0.10
	TIMES LOCAL:1, 0.80
	TIMES LOCAL:2, 0.80
	TIMES LOCAL:4, 0.90
ELSE
	TIMES LOCAL:0, 0.00
	TIMES LOCAL:1, 1.00
	TIMES LOCAL:2, 1.00
ENDIF

;우후후 주도도를 본다
LOCAL:5 = ABL:(ARG:0):주도도Ｕ
IF GETBIT(TALENT:(ARG:0):음란계, 소질_음란_마조)
	TIMES LOCAL:0, 2.00
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 0.50
ELSEIF LOCAL:5 <= -500
	TIMES LOCAL:0, 1.60
	TIMES LOCAL:1, 0.70
	TIMES LOCAL:2, 0.70
ELSEIF LOCAL:5 <= -300
	TIMES LOCAL:0, 1.40
	TIMES LOCAL:1, 0.80
	TIMES LOCAL:2, 0.80
ELSEIF LOCAL:5 <= -100
	TIMES LOCAL:0, 1.20
	TIMES LOCAL:1, 0.90
	TIMES LOCAL:2, 0.90
ELSEIF LOCAL:5 < 100
	TIMES LOCAL:0, 1.00
	TIMES LOCAL:1, 1.00
	TIMES LOCAL:2, 1.00
ELSEIF LOCAL:5 < 300
	TIMES LOCAL:0, 0.90
	TIMES LOCAL:1, 1.10
	TIMES LOCAL:2, 1.10
ELSEIF LOCAL:5 < 500
	TIMES LOCAL:0, 0.80
	TIMES LOCAL:1, 1.20
	TIMES LOCAL:2, 1.20
ELSE
	TIMES LOCAL:0, 0.60
	TIMES LOCAL:1, 1.30
	TIMES LOCAL:2, 1.30
ENDIF

;마조를 본다
SELECTCASE ABL:(ARG:0):마조
	CASE 0
		TIMES LOCAL:0, 0.50
		TIMES LOCAL:1, 1.10
		TIMES LOCAL:2, 1.10
		TIMES LOCAL:3, 1.10
	CASE 1
		TIMES LOCAL:0, 0.80
		TIMES LOCAL:1, 1.05
		TIMES LOCAL:2, 1.05
		TIMES LOCAL:3, 1.05
	CASE 2
		TIMES LOCAL:0, 1.0
		TIMES LOCAL:1, 1.0
		TIMES LOCAL:2, 1.0
		TIMES LOCAL:3, 1.0
	CASE 3
		TIMES LOCAL:0, 1.1
		TIMES LOCAL:1, 0.80
		TIMES LOCAL:2, 0.80
		TIMES LOCAL:3, 0.80
	CASE 4
		TIMES LOCAL:0, 1.2
		TIMES LOCAL:1, 0.60
		TIMES LOCAL:2, 0.60
		TIMES LOCAL:3, 0.60
	CASEELSE
		LOCAL:0 = LOCAL:0 * ((ABL:(ARG:0):마조 - 5) * 5 + 140) / 100
		TIMES LOCAL:1, 0.20
		TIMES LOCAL:3, 0.20
		IF TALENT:(ARG:0):억압
			TIMES LOCAL:2, 0.50
		ELSE
			TIMES LOCAL:2, 0.20
		ENDIF
ENDSELECT

IF TALENT:(ARG:0):아픔에강함
	TIMES LOCAL:2, 0.80
	TIMES LOCAL:3, 0.70
	TIMES LOCAL:4, 0.70
ENDIF

;아픔에약함
IF TALENT:(ARG:0):아픔에약함
	TIMES LOCAL:2, 2.00
	TIMES LOCAL:3, 2.00
	TIMES LOCAL:4, 1.25
ENDIF

;고통쾌락경험 1에 대해 0.1%컷, 최대 700으로 70%
LOCAL:4 = LOCAL:4 - LOCAL:4 * MIN(EXP:(ARG:0):고통쾌락경험, 700) / 1000

;소비량이 너무 많은 경우의 경감 조치( 400이후, 200 걸러서 초과분을 20% 감쇠)
FOR LOCAL:10, 0, 30
	LOCAL:11 = LOCAL:10 * 200 + 400
	IF LOCAL:4 < LOCAL:11
		BREAK
	ENDIF
	LOCAL:4 = LOCAL:11 + (LOCAL:4 - LOCAL:11) * 4 / 5
NEXT

CUP:(ARG:0):욕정 += LOCAL:0
CUP:(ARG:0):로주 += LOCAL:1
CUP:(ARG:0):액주 += LOCAL:2
CUP:(ARG:0):포주 += LOCAL:3

DOWNBASE:(ARG:0):체력 += LOCAL:4

;-------------------------------------------------
;노출의 소스
;-------------------------------------------------
@CALC_SOURCE20(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):노출
LOCAL:1 = SOURCE:(ARG:0):노출
LOCAL:2 = SOURCE:(ARG:0):노출
LOCAL:3 = SOURCE:(ARG:0):노출 / 2

SELECTCASE ABL:(ARG:0):노출
	CASE 0
		TIMES LOCAL:0, 0.00
		TIMES LOCAL:1, 1.00
		TIMES LOCAL:2, 1.00
		TIMES LOCAL:3, 1.00
	CASE 1
		TIMES LOCAL:0, 0.20
		TIMES LOCAL:1, 0.80
		TIMES LOCAL:2, 0.80
		TIMES LOCAL:3, 0.70
	CASE 2
		TIMES LOCAL:0, 0.40
		TIMES LOCAL:1, 0.60
		TIMES LOCAL:2, 0.60
		TIMES LOCAL:3, 0.40
	CASE 3
		TIMES LOCAL:0, 0.70
		TIMES LOCAL:1, 0.40
		TIMES LOCAL:2, 0.40
		TIMES LOCAL:3, 0.20
	CASE 4
		TIMES LOCAL:0, 1.00
		TIMES LOCAL:1, 0.15
		TIMES LOCAL:2, 0.15
		TIMES LOCAL:3, 0.05
	CASEELSE
		LOCAL:0 = LOCAL:0 * ((ABL:(ARG:0):노출 - 5) * 5 + 140) / 100
		TIMES LOCAL:1, 0.05
		TIMES LOCAL:3, 0.00
		IF TALENT:(ARG:0):억압
			TIMES LOCAL:2, 0.10
		ELSE
			TIMES LOCAL:2, 0.00
		ENDIF
ENDSELECT

;친밀도로 의존도의 큰 (분)편을 본다
LOCAL:5 = MAX(CFLAG:(ARG:0):2, CFLAG:(ARG:0):3)
IF LOCAL:5 < 100
	TIMES LOCAL:1, 1.00
	TIMES LOCAL:2, 1.00
	TIMES LOCAL:3, 1.00
ELSEIF LOCAL:5 < 300
	TIMES LOCAL:1, 0.90
	TIMES LOCAL:2, 0.90
	TIMES LOCAL:3, 0.90
ELSEIF LOCAL:5 < 500
	TIMES LOCAL:1, 0.70
	TIMES LOCAL:2, 0.70
	TIMES LOCAL:3, 0.80
ELSEIF LOCAL:5 < 800
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 0.50
	TIMES LOCAL:3, 0.60
ELSEIF LOCAL:5 < 1500
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:2, 0.20
	TIMES LOCAL:3, 0.50
ELSEIF LOCAL:5 < 3000
	TIMES LOCAL:1, 0.10
	TIMES LOCAL:2, 0.10
	TIMES LOCAL:3, 0.40
ELSE
	TIMES LOCAL:1, 0.05
	TIMES LOCAL:2, 0.05
	TIMES LOCAL:3, 0.30
ENDIF

;수줍음과 수치심옅음은 여기서 처리
IF TALENT:(ARG:0):수줍음
	TIMES LOCAL:1, 1.50
	TIMES LOCAL:2, 1.50
	TIMES LOCAL:3, 2.00
ENDIF
IF TALENT:(ARG:0):수치심옅음
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 0.50
	TIMES LOCAL:3, 0.50
ENDIF

IF !TALENT:(ARG:0):억압
	TIMES LOCAL:2, 0.30
ENDIF

IF GETBIT(TALENT:(ARG:0):음란계, 소질_음란_노출광)
	TIMES LOCAL:0, 1.25
	TIMES LOCAL:1, 0.1
	TIMES LOCAL:2, 0.1
	TIMES LOCAL:3, 0.1
ENDIF

CUP:(ARG:0):욕정 += LOCAL:0
CUP:(ARG:0):로주 += LOCAL:1
CUP:(ARG:0):액주 += LOCAL:2
CUP:(ARG:0):포주 += LOCAL:3

;-------------------------------------------------
;불결의 소스
;-------------------------------------------------
@CALC_SOURCE21(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):불결

;친밀도로 의존도의 큰 (분)편을 본다
LOCAL:5 = MAX(CFLAG:(ARG:0):2, CFLAG:(ARG:0):3)
IF LOCAL:5 < 100
	TIMES LOCAL:0, 1.00
ELSEIF LOCAL:5 < 300
	TIMES LOCAL:0, 0.90
ELSEIF LOCAL:5 < 500
	TIMES LOCAL:0, 0.70
ELSEIF LOCAL:5 < 800
	TIMES LOCAL:0, 0.50
ELSEIF LOCAL:5 < 1500
	TIMES LOCAL:0, 0.20
ELSEIF LOCAL:5 < 3000
	TIMES LOCAL:0, 0.10
ELSE
	TIMES LOCAL:0, 0.05
ENDIF

IF TALENT:(ARG:0):불결무시
	TIMES LOCAL:0, 0.00
ELSE
	IF TALENT:(ARG:0):악취민감
		TIMES LOCAL:0, 2.00
	ENDIF
	IF TALENT:(ARG:0):악취둔감
		TIMES LOCAL:0, 0.50
	ENDIF
ENDIF

CUP:(ARG:0):로주 += LOCAL:0
CUP:(ARG:0):액주 += LOCAL:0

;호감도 감소
TCVAR:(ARG:0):15 += LOCAL:0

;-------------------------------------------------
;일탈의 소스
;-------------------------------------------------
@CALC_SOURCE22(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):일탈
LOCAL:1 = SOURCE:(ARG:0):일탈 / 2
LOCAL:2 = SOURCE:(ARG:0):일탈

;친밀도로 의존도의 큰 (분)편을 본다
LOCAL:5 = MAX(CFLAG:(ARG:0):2, CFLAG:(ARG:0):3)
IF LOCAL:5 < 100
	TIMES LOCAL:0, 1.00
	TIMES LOCAL:1, 1.00
	TIMES LOCAL:2, 1.00
ELSEIF LOCAL:5 < 300
	TIMES LOCAL:0, 0.90
	TIMES LOCAL:1, 0.90
	TIMES LOCAL:2, 0.90
ELSEIF LOCAL:5 < 500
	TIMES LOCAL:0, 0.70
	TIMES LOCAL:1, 0.70
	TIMES LOCAL:2, 0.80
ELSEIF LOCAL:5 < 800
	TIMES LOCAL:0, 0.50
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 0.60
ELSEIF LOCAL:5 < 1500
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:2, 0.50
ELSEIF LOCAL:5 < 3000
	TIMES LOCAL:0, 0.10
	TIMES LOCAL:1, 0.10
	TIMES LOCAL:2, 0.40
ELSE
	TIMES LOCAL:0, 0.05
	TIMES LOCAL:1, 0.05
	TIMES LOCAL:2, 0.30
ENDIF

;도착도를 본다
LOCAL:5 = ABL:(ARG:0):도착도
IF GETBIT(TALENT:(ARG:0):음란계, 소질_음란_마조)
	TIMES LOCAL:0, 0.00
	TIMES LOCAL:1, 0.00
	TIMES LOCAL:2, 0.05
ELSEIF LOCAL:5 >= 800
	TIMES LOCAL:0, 0.15
	TIMES LOCAL:1, 0.15
	TIMES LOCAL:2, 0.30
ELSEIF LOCAL:5 >= 500
	TIMES LOCAL:0, 0.40
	TIMES LOCAL:1, 0.40
	TIMES LOCAL:2, 0.60
ELSEIF LOCAL:5 >= 300
	TIMES LOCAL:0, 0.60
	TIMES LOCAL:1, 0.60
	TIMES LOCAL:2, 0.80
ELSEIF LOCAL:5 >= 100
	TIMES LOCAL:0, 0.80
	TIMES LOCAL:1, 0.80
	TIMES LOCAL:2, 0.90
ELSE
	TIMES LOCAL:0, 1.00
	TIMES LOCAL:1, 1.00
	TIMES LOCAL:2, 1.00
ENDIF

IF TALENT:(ARG:0):호기심
	TIMES LOCAL:0, 0.50
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 0.50
ENDIF

IF TALENT:(ARG:0):보수적
	TIMES LOCAL:0, 2.00
	TIMES LOCAL:1, 2.00
	TIMES LOCAL:2, 2.00
ENDIF

IF TALENT:(ARG:0):도착적
	TIMES LOCAL:0, 0.50
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 0.50
ENDIF

CUP:(ARG:0):로주 += LOCAL:0
CUP:(ARG:0):액주 += LOCAL:1
CUP:(ARG:0):포주 += LOCAL:2

;-------------------------------------------------
;기학의 소스
;-------------------------------------------------
@CALC_SOURCE23(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):기학 * 2
LOCAL:1 = SOURCE:(ARG:0):기학
LOCAL:2 = SOURCE:(ARG:0):기학
LOCAL:3 = SOURCE:(ARG:0):기학

LOCAL:5 = ABL:(ARG:0):주도도Ｕ
IF GETBIT(TALENT:(ARG:0):음란계, 소질_음란_새드)
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 1.50
	TIMES LOCAL:2, 0.00
	TIMES LOCAL:3, 1.80
ELSEIF LOCAL:5 <= -500
	TIMES LOCAL:0, 0.00
	TIMES LOCAL:1, 0.00
	TIMES LOCAL:2, 1.00
	TIMES LOCAL:3, 0.70
ELSEIF LOCAL:5 <= -300
	TIMES LOCAL:0, 0.00
	TIMES LOCAL:1, 0.00
	TIMES LOCAL:2, 1.00
	TIMES LOCAL:3, 0.80
ELSEIF LOCAL:5 <= -100
	TIMES LOCAL:0, 0.05
	TIMES LOCAL:1, 0.05
	TIMES LOCAL:2, 1.00
	TIMES LOCAL:3, 0.90
ELSEIF LOCAL:5 < 100
	TIMES LOCAL:0, 0.10
	TIMES LOCAL:1, 0.10
	TIMES LOCAL:2, 0.70
	TIMES LOCAL:3, 1.00
ELSEIF LOCAL:5 < 300
	TIMES LOCAL:0, 0.30
	TIMES LOCAL:1, 0.30
	TIMES LOCAL:2, 0.30
	TIMES LOCAL:3, 1.10
ELSEIF LOCAL:5 < 500
	TIMES LOCAL:0, 0.60
	TIMES LOCAL:1, 0.60
	TIMES LOCAL:2, 0.05
	TIMES LOCAL:3, 1.30
ELSE
	TIMES LOCAL:0, 1.00
	TIMES LOCAL:1, 1.00
	TIMES LOCAL:2, 0.00
	TIMES LOCAL:3, 1.50
ENDIF

LOCAL:5 = ABL:(ARG:0):도착도
IF GETBIT(TALENT:(ARG:0):음란계, 소질_음란_새드) || LOCAL:5 >= 800
	TIMES LOCAL:0, 1.00
	TIMES LOCAL:1, 1.00
	TIMES LOCAL:2, 0.10
ELSEIF LOCAL:5 >= 500
	TIMES LOCAL:0, 0.90
	TIMES LOCAL:1, 0.90
	TIMES LOCAL:2, 0.30
ELSEIF LOCAL:5 >= 300
	TIMES LOCAL:0, 0.80
	TIMES LOCAL:1, 0.80
	TIMES LOCAL:2, 0.50
ELSEIF LOCAL:5 >= 100
	TIMES LOCAL:0, 0.60
	TIMES LOCAL:1, 0.60
	TIMES LOCAL:2, 0.80
ELSE
	TIMES LOCAL:0, 0.40
	TIMES LOCAL:1, 0.40
	TIMES LOCAL:2, 1.00
ENDIF

;새드를 본다
SELECTCASE ABL:(ARG:0):새드
	CASE 0
		TIMES LOCAL:0, 0.50
		TIMES LOCAL:1, 1.10
		TIMES LOCAL:2, 1.10
		TIMES LOCAL:3, 1.10
	CASE 1
		TIMES LOCAL:0, 0.80
		TIMES LOCAL:1, 1.05
		TIMES LOCAL:2, 1.05
		TIMES LOCAL:3, 1.05
	CASE 2
		TIMES LOCAL:0, 1.0
		TIMES LOCAL:1, 1.0
		TIMES LOCAL:2, 1.0
		TIMES LOCAL:3, 1.0
	CASE 3
		TIMES LOCAL:0, 1.1
		TIMES LOCAL:1, 0.80
		TIMES LOCAL:2, 0.80
		TIMES LOCAL:3, 0.80
	CASE 4
		TIMES LOCAL:0, 1.2
		TIMES LOCAL:1, 0.60
		TIMES LOCAL:2, 0.60
		TIMES LOCAL:3, 0.60
	CASEELSE
		LOCAL:0 = LOCAL:0 * ((ABL:(ARG:0):마조 - 5) * 5 + 140) / 100
		TIMES LOCAL:1, 0.20
		TIMES LOCAL:3, 0.20
		IF TALENT:(ARG:0):억압
			TIMES LOCAL:2, 0.50
		ELSE
			TIMES LOCAL:2, 0.20
		ENDIF
ENDSELECT

IF TALENT:(ARG:0):주인
	TIMES LOCAL:0, 1.30
	TIMES LOCAL:1, 1.30
ENDIF
IF TALENT:(ARG:0):소유자
	TIMES LOCAL:0, 1.30
	TIMES LOCAL:1, 1.30
ENDIF

;욕망에 의한 욕정의 보정
LOCAL:0 = CALC_SOURCE_YOKUBOU(ARG:0, LOCAL:0)

CUP:(ARG:0):욕정 += LOCAL:0
CUP:(ARG:0):로주 -= LOCAL:1
CUP:(ARG:0):액주 -= LOCAL:1
CUP:(ARG:0):포주 += LOCAL:2

;호감도 상승
TCVAR:(ARG:0):10 += LOCAL:1 * 10

;의존도 상승
TCVAR:(ARG:0):11 += LOCAL:1 * 4

;종속도 감소
TCVAR:(ARG:0):17 += LOCAL:3 * 10

;지배도 상승
TCVAR:(ARG:0):74 += LOCAL:1 * 15

;-------------------------------------------------
;감응의 소스
;-------------------------------------------------
@CALC_SOURCE24(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):감응
LOCAL:1 = SOURCE:(ARG:0):감응
LOCAL:2 = SOURCE:(ARG:0):감응
LOCAL:3 = SOURCE:(ARG:0):감응

LOCAL:0 = CALC_SOURCE_YOKUBOU(ARG:0, LOCAL:0)

SELECTCASE ABL:(ARG:0):욕망
	CASE 0
		TIMES LOCAL:1, 1.00
		TIMES LOCAL:2, 1.00
		TIMES LOCAL:3, 1.00
	CASE 1
		TIMES LOCAL:1, 0.85
		TIMES LOCAL:2, 0.85
		TIMES LOCAL:3, 0.85
	CASE 2
		TIMES LOCAL:1, 0.70
		TIMES LOCAL:2, 0.70
		TIMES LOCAL:3, 0.70
	CASE 3
		TIMES LOCAL:1, 0.40
		TIMES LOCAL:2, 0.40
		TIMES LOCAL:3, 0.40
	CASE 4
		TIMES LOCAL:1, 0.30
		TIMES LOCAL:2, 0.30
		TIMES LOCAL:3, 0.30
	CASEELSE
		LOCAL:1 = LOCAL:1 * 2 / (ABL:(ARG:0):욕망 + 15)
		LOCAL:2 = LOCAL:2 * 2 / (ABL:(ARG:0):욕망 + 15)
		LOCAL:3 = LOCAL:3 * 2 / (ABL:(ARG:0):욕망 + 15)
ENDSELECT

IF TALENT:(ARG:0):호기심
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 0.50
ENDIF

IF TALENT:(ARG:0):보수적
	TIMES LOCAL:0, 0.75
	TIMES LOCAL:1, 1.50
ENDIF

IF TALENT:(ARG:0):무관심
	TIMES LOCAL:0, 0.30
	TIMES LOCAL:1, 0.30
	TIMES LOCAL:2, 0.30
	TIMES LOCAL:3, 0.30
ENDIF

IF TALENT:(ARG:0):고고함
	TIMES LOCAL:1, 1.50
	TIMES LOCAL:2, 1.50
ENDIF

IF TALENT:(ARG:0):억압
	TIMES LOCAL:2, 2.00
ENDIF

IF TALENT:(ARG:0):쾌감을부정
	TIMES LOCAL:1, 1.30
	TIMES LOCAL:3, 1.30
ENDIF

IF !(TALENT:(ARG:0):고고함 || TALENT:(ARG:0):억압 || TALENT:(ARG:0):쾌감을부정)
	LOCAL:2 = 0
ENDIF

CUP:(ARG:0):욕정 += LOCAL:0
CUP:(ARG:0):로주 += LOCAL:1 / 6
CUP:(ARG:0):액주 += LOCAL:2 / 4
CUP:(ARG:0):포주 += LOCAL:3 / 8

;-------------------------------------------------
;해소의 소스
;-------------------------------------------------
@CALC_SOURCE25(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):해소

LOCAL:5 = MAX(PALAM:(ARG:0):로외, PALAM:(ARG:0):액외, PALAM:(ARG:0):포외)

IF LOCAL:5 == PALAM:(ARG:0):로외
	CUP:(ARG:0):로외 -= LOCAL:0
ELSEIF LOCAL:5 == PALAM:(ARG:0):액외
	CUP:(ARG:0):액외 -= LOCAL:0
ELSE
	CUP:(ARG:0):포외 -= LOCAL:0
ENDIF

;호감도 상승
TCVAR:(ARG:0):10 += LOCAL:0 * 100 / 15

;의존도 상승
TCVAR:(ARG:0):11 += LOCAL:0 * 100 / 15

;무드의 상승
TFLAG:37 += LOCAL:0 / 100

;-------------------------------------------------
;환희의 소스
;-------------------------------------------------
@CALC_SOURCE26(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):환희

CUP:(ARG:0):로주 -= LOCAL:0
CUP:(ARG:0):액주 -= LOCAL:0
CUP:(ARG:0):포주 -= LOCAL:0

;-------------------------------------------------
;촉수의 소스
;-------------------------------------------------
@CALC_SOURCE27(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):촉수
LOCAL:1 = SOURCE:(ARG:0):촉수 * 2
LOCAL:2 = SOURCE:(ARG:0):촉수

SELECTCASE ABL:(ARG:0):촉수
	CASE 0
		TIMES LOCAL:0, 1.00
		TIMES LOCAL:1, 1.00
		TIMES LOCAL:2, 0.05
	CASE 1
		TIMES LOCAL:0, 0.80
		TIMES LOCAL:1, 0.90
		TIMES LOCAL:2, 0.15
	CASE 2
		TIMES LOCAL:0, 0.50
		TIMES LOCAL:1, 0.65
		TIMES LOCAL:2, 0.40
	CASE 3
		TIMES LOCAL:0, 0.20
		TIMES LOCAL:1, 0.40
		TIMES LOCAL:2, 0.70
	CASE 4
		TIMES LOCAL:0, 0.05
		TIMES LOCAL:1, 0.20
		TIMES LOCAL:2, 1.00
	CASEELSE
		LOCAL:0 = LOCAL:0 / ((ABL:(ARG:0):촉수 - 5) * 100 + 500)
		LOCAL:1 = LOCAL:1 / ((ABL:(ARG:0):촉수 - 5) * 50 + 150)
		LOCAL:2 = LOCAL:2 * ((ABL:(ARG:0):촉수 - 5) * 10 + 180) / 100
ENDSELECT

SELECTCASE ABL:(ARG:0):욕망
	CASE 0
		TIMES LOCAL:0, 1.00
	CASE 1
		TIMES LOCAL:0, 0.95
	CASE 2
		TIMES LOCAL:0, 0.90
	CASE 3
		TIMES LOCAL:0, 0.80
	CASE 4
		TIMES LOCAL:0, 0.70
	CASEELSE
		LOCAL:0 = LOCAL:0 * 10 / ((ABL:(ARG:0):욕망 - 5) * 3 + 18)
ENDSELECT

LOCAL:5 = ABL:(ARG:0):도착도
IF GETBIT(TALENT:(ARG:0):음란계, 소질_음란_마조) || LOCAL:5 >= 800
	TIMES LOCAL:0, 0.30
	TIMES LOCAL:1, 0.30
	TIMES LOCAL:2, 1.80
ELSEIF LOCAL:5 >= 500
	TIMES LOCAL:0, 0.50
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 1.50
ELSEIF LOCAL:5 >= 300
	TIMES LOCAL:0, 0.70
	TIMES LOCAL:1, 0.70
	TIMES LOCAL:2, 1.30
ELSEIF LOCAL:5 >= 100
	TIMES LOCAL:0, 0.90
	TIMES LOCAL:1, 0.90
	TIMES LOCAL:2, 1.10
ELSE
	TIMES LOCAL:0, 1.00
	TIMES LOCAL:1, 1.00
	TIMES LOCAL:2, 1.00
ENDIF

CUP:(ARG:0):로주 += LOCAL:0
CUP:(ARG:0):액주 += LOCAL:0 / 2
CUP:(ARG:0):포주 += LOCAL:1
CUP:(ARG:0):욕정 += CALC_SOURCE_YOKUBOU(ARG:0, LOCAL:2)

;-------------------------------------------------
;주도의 소스
;-------------------------------------------------
@CALC_SOURCE28(ARG:0)
;주도도가 낮으면 「비」가 오른다
LOCAL:0 = SOURCE:(ARG:0):주도
LOCAL:1 = SOURCE:(ARG:0):주도
LOCAL:2 = SOURCE:(ARG:0):주도

LOCAL:5 = ABL:(ARG:0):주도도Ｎ
IF LOCAL:5 >= 500 || GETBIT(TALENT:(ARG:0):음란계, 소질_음란_새드)
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 1.00
	TIMES LOCAL:2, 1.50
ELSEIF LOCAL:5 >= 300
	TIMES LOCAL:0, 1.00
	TIMES LOCAL:1, 0.60
	TIMES LOCAL:2, 1.30
ELSEIF LOCAL:5 >= 100
	TIMES LOCAL:0, 0.50
	TIMES LOCAL:1, 0.30
	TIMES LOCAL:2, 1.10
ELSEIF LOCAL:5 > -100
	TIMES LOCAL:0, 0.00
	TIMES LOCAL:1, 0.00
	TIMES LOCAL:2, 1.00
ELSEIF LOCAL:5 > -300
	TIMES LOCAL:0, 0.00
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 0.90
	LOCAL:1 *= -1
ELSEIF LOCAL:5 > -500
	TIMES LOCAL:0, 0.00
	TIMES LOCAL:1, 1.00
	TIMES LOCAL:2, 0.80
	LOCAL:1 *= -1
ELSE
	TIMES LOCAL:0, 0.00
	TIMES LOCAL:1, 1.50
	TIMES LOCAL:2, 0.70
	LOCAL:1 *= -1
ENDIF

IF TALENT:(ARG:0):주인
	TIMES LOCAL:0, 1.30
	TIMES LOCAL:1, 1.30
ENDIF
IF TALENT:(ARG:0):소유자
	TIMES LOCAL:0, 1.30
	TIMES LOCAL:1, 1.30
ENDIF

CUP:(ARG:0):로주 -= LOCAL:0
CUP:(ARG:0):액주 -= LOCAL:1

;호감도 상승
TCVAR:(ARG:0):10 += (LOCAL:0 + LOCAL:1) * 2

;종속도 감소
TCVAR:(ARG:0):17 += LOCAL:2 * 2

;지배도 상승
TCVAR:(ARG:0):74 += (LOCAL:0 + LOCAL:1) * 3 / 2

;-------------------------------------------------
;수동의 소스
;-------------------------------------------------
@CALC_SOURCE29(ARG:0)
;주도도가 높면 「로」가 오른다
LOCAL:0 = SOURCE:(ARG:0):수동
LOCAL:1 = SOURCE:(ARG:0):수동
LOCAL:2 = SOURCE:(ARG:0):수동

LOCAL:5 = ABL:(ARG:0):주도도Ｎ
IF LOCAL:5 <= -500 || GETBIT(TALENT:(ARG:0):음란계, 소질_음란_마조)
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 1.00
	TIMES LOCAL:2, 1.50
ELSEIF LOCAL:5 <= -300
	TIMES LOCAL:0, 1.00
	TIMES LOCAL:1, 0.60
	TIMES LOCAL:2, 1.30
ELSEIF LOCAL:5 <= -100
	TIMES LOCAL:0, 0.50
	TIMES LOCAL:1, 0.30
	TIMES LOCAL:2, 1.10
ELSEIF LOCAL:5 < 100
	TIMES LOCAL:0, 0.00
	TIMES LOCAL:1, 0.00
	TIMES LOCAL:2, 1.00
ELSEIF LOCAL:5 < 300
	TIMES LOCAL:0, 0.00
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 0.90
	LOCAL:1 *= -1
ELSEIF LOCAL:5 < 500
	TIMES LOCAL:0, 0.00
	TIMES LOCAL:1, 1.00
	TIMES LOCAL:2, 0.80
	LOCAL:1 *= -1
ELSE
	TIMES LOCAL:0, 0.00
	TIMES LOCAL:1, 1.50
	TIMES LOCAL:2, 0.70
	LOCAL:1 *= -1
ENDIF

CUP:(ARG:0):로주 -= LOCAL:1
CUP:(ARG:0):액주 -= LOCAL:0

;호감도 상승
TCVAR:(ARG:0):10 += (LOCAL:0 + LOCAL:1) * 2

;종속도 상승
TCVAR:(ARG:0):12 += LOCAL:2 * 2

;지배도 감소
TCVAR:(ARG:0):75 += LOCAL:2 / 3


;-------------------------------------------------
;중독충족의 소스
;-------------------------------------------------
@CALC_SOURCE30(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):중독충족 * 5
LOCAL:1 = SOURCE:(ARG:0):중독충족

LOCAL:0 = CALC_SOURCE_YOKUBOU(ARG:0, LOCAL:0)

CUP:(ARG:0):욕정 += LOCAL:0
CUP:(ARG:0):로주 -= LOCAL:1
CUP:(ARG:0):액주 -= LOCAL:1
CUP:(ARG:0):포주 -= LOCAL:1 * 2 / 3

;호감도 상승
TCVAR:(ARG:0):10 += LOCAL:1 / 6

;의존도 상승
TCVAR:(ARG:0):11 += LOCAL:1 / 2

;-------------------------------------------------
;비애의 소스
;-------------------------------------------------
@CALC_SOURCE31(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):비애

CUP:(ARG:0):로주 += LOCAL:0 / 5
CUP:(ARG:0):액주 += LOCAL:0

;호감도 감소
TCVAR:(ARG:0):15 += LOCAL:0 / 5

;의존도 감소
TCVAR:(ARG:0):16 += LOCAL:0 / 3

;종속도 감소
TCVAR:(ARG:0):17 += LOCAL:0 / 5

;지배도 감소
TCVAR:(ARG:0):75 += LOCAL:0 / 6


;-------------------------------------------------
;불만의 소스
;-------------------------------------------------
@CALC_SOURCE32(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):불만

CUP:(ARG:0):로주 += LOCAL:0 / 10
CUP:(ARG:0):액주 += LOCAL:0 / 10

;호감도 감소
TCVAR:(ARG:0):15 += LOCAL:0

;의존도 감소
TCVAR:(ARG:0):16 += LOCAL:0 / 2

;종속도 감소
TCVAR:(ARG:0):17 += LOCAL:0 / 3

;지배도 감소
TCVAR:(ARG:0):75 += LOCAL:0 / 4

;-------------------------------------------------
;성행동의 소스
;-------------------------------------------------
@CALC_SOURCE33(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):성행동
LOCAL:1 = SOURCE:(ARG:0):성행동
LOCAL:2 = SOURCE:(ARG:0):성행동
LOCAL:3 = SOURCE:(ARG:0):성행동

SELECTCASE ABL:(ARG:0):욕망
	CASE 0
		TIMES LOCAL:0, 1.00
		TIMES LOCAL:1, 1.00
	CASE 1
		TIMES LOCAL:0, 0.90
		TIMES LOCAL:1, 0.80
	CASE 2
		TIMES LOCAL:0, 0.75
		TIMES LOCAL:1, 0.50
	CASE 3
		TIMES LOCAL:0, 0.60
		TIMES LOCAL:1, 0.25
	CASE 4
		TIMES LOCAL:0, 0.50
		TIMES LOCAL:1, 0.10
	CASEELSE
		LOCAL:0 = LOCAL:0 * 4 / (ABL:(ARG:0):욕망 + 5)
		LOCAL:1 = LOCAL:1 / ((ABL:(ARG:0):욕망 + 5) * 2)
ENDSELECT

;친밀도로 의존도의 큰 (분)편을 본다
LOCAL:5 = MAX(CFLAG:(ARG:0):2, CFLAG:(ARG:0):3)
IF LOCAL:5 < 100
	TIMES LOCAL:0, 1.00
	TIMES LOCAL:1, 1.00
	TIMES LOCAL:2, 1.00
ELSEIF LOCAL:5 < 300
	TIMES LOCAL:0, 0.90
	TIMES LOCAL:1, 0.90
	TIMES LOCAL:2, 0.90
ELSEIF LOCAL:5 < 500
	TIMES LOCAL:0, 0.70
	TIMES LOCAL:1, 0.70
	TIMES LOCAL:2, 0.80
ELSEIF LOCAL:5 < 800
	TIMES LOCAL:0, 0.50
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 0.60
ELSEIF LOCAL:5 < 1500
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:2, 0.50
ELSEIF LOCAL:5 < 3000
	TIMES LOCAL:0, 0.10
	TIMES LOCAL:1, 0.10
	TIMES LOCAL:2, 0.40
ELSE
	TIMES LOCAL:0, 0.05
	TIMES LOCAL:1, 0.05
	TIMES LOCAL:2, 0.30
ENDIF

IF TALENT:(ARG:0):쾌감을부정
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:2, 1.50
ENDIF

IF TALENT:(ARG:0):보수적
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:2, 1.50
ENDIF

IF TALENT:(ARG:0):호기심
	TIMES LOCAL:0, 0.80
	TIMES LOCAL:2, 0.80
ENDIF

IF TALENT:(ARG:0):프라이드높음
	TIMES LOCAL:0, 1.20
ELSEIF TALENT:(ARG:0):프라이드낮음
	TIMES LOCAL:0, 0.80
ENDIF

IF TALENT:(ARG:0):친애
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 0.20
ELSEIF TALENT:(ARG:0):연모
	TIMES LOCAL:0, 0.40
	TIMES LOCAL:1, 0.75
	TIMES LOCAL:2, 0.40
ENDIF

IF TALENT:(ARG:0):연인
	TIMES LOCAL:0, 0.70
	TIMES LOCAL:1, 0.80
	TIMES LOCAL:2, 0.70
ENDIF

IF TALENT:(ARG:0):예속
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:2, 0.10
ELSEIF TALENT:(ARG:0):복종
	TIMES LOCAL:0, 0.40
	TIMES LOCAL:2, 0.25
ENDIF

IF TALENT:(ARG:0):낙인
	TIMES LOCAL:0, 0.70
	TIMES LOCAL:2, 0.70
ENDIF

IF IS_FALLEN_TO_SP_COUNTRY(ARG:0)
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 0.30
ENDIF

IF TALENT:(ARG:0):합의
	TIMES LOCAL:0, 0.40
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 0.40
ELSE
	IF TALENT:(ARG:0):정조관념
		TIMES LOCAL:0, 1.50
		TIMES LOCAL:2, 1.50
	ENDIF
	IF TALENT:(ARG:0):정조관념없음
		TIMES LOCAL:0, 0.75
		TIMES LOCAL:2, 0.75
	ENDIF
ENDIF

IF TALENT:(ARG:0):성별 == 0
	TIMES LOCAL:0, 0.50
	TIMES LOCAL:1, 0.50
ELSEIF GROUPMATCH(TALENT:(ARG:0):성별, 3, 4, 5)
	TIMES LOCAL:0, 0.80
	TIMES LOCAL:1, 0.80
ENDIF

;도원향 사용중
IF TFLAG:69
	TIMES LOCAL:0, 0.80
	TIMES LOCAL:1, 0.90
	TIMES LOCAL:2, 0.80
ENDIF

IF ABL:(ARG:0):성지식 == 0
	LOCAL:0 = 0
ENDIF

IF !TALENT:(ARG:0):고고함 && !TALENT:(ARG:0):억압
	LOCAL:2 = 0
ENDIF

CUP:(ARG:0):욕정 += CALC_SOURCE_YOKUBOU(ARG:0, LOCAL:3 / 2)

CUP:(ARG:0):로주 += LOCAL:0
CUP:(ARG:0):액주 += LOCAL:0
CUP:(ARG:0):포주 += LOCAL:1

;호감도 감소
TCVAR:(ARG:0):15 += LOCAL:0

;의존도 감소
TCVAR:(ARG:0):16 += LOCAL:2 / 3

;종속도 감소
TCVAR:(ARG:0):17 += LOCAL:2 / 2

;지배도 감소
TCVAR:(ARG:0):75 += LOCAL:2 / 2


;-------------------------------------------------
;액체 추가의 소스
;-------------------------------------------------
@CALC_SOURCE40(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):액체추가

CUP:(ARG:0):윤활 += LOCAL:0

;-------------------------------------------------
;욕정 추가의 소스
;-------------------------------------------------
@CALC_SOURCE41(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):욕정추가

CUP:(ARG:0):욕정 += LOCAL:0

;-------------------------------------------------
;취기 추가의 소스
;-------------------------------------------------
@CALC_SOURCE50(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):취기추가


IF TALENT:(ARG:0):폭주가
	TIMES LOCAL:0, 0.8
ELSEIF TALENT:(ARG:0):술못함
	TIMES LOCAL:0, 1.2
ELSE
	IF TALENT:(ARG:0):유아
		TIMES LOCAL:0, 3.00
	ELSEIF TALENT:(ARG:0):체격 == 체격_작은체형
		TIMES LOCAL:0, 1.50
	ENDIF
ENDIF

CUP:(ARG:0):취기 += LOCAL:0


;-------------------------------------------------
;약물 추가의 소스
;-------------------------------------------------
@CALC_SOURCE52(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):약물추가
IF GETBIT(TALENT:(ARG:0):음란계, 소질_음란_약물중독)
	TIMES LOCAL:0, 0.50
ELSE
	IF TALENT:(ARG:0):유아
		TIMES LOCAL:0, 3.00
	ELSEIF TALENT:(ARG:0):체격 == 체격_작은체형
		TIMES LOCAL:0, 1.50
	ENDIF
ENDIF

CUP:(ARG:0):약물 += LOCAL:0
;-------------------------------------------------
;욕망에 의한 욕정의 공통 보정 ARG:0=캐릭터 번호, ARG:1=욕정 상승의 기본치
;-------------------------------------------------
@CALC_SOURCE_YOKUBOU(ARG:0, ARG:1)
#FUNCTION
LOCAL:0 = ARG:1

;미약사용중
IF TCVAR:(ARG:0):60
	TIMES LOCAL:0, 2.00
ENDIF

;도원향 사용중
IF TFLAG:69
	TIMES LOCAL:0, 1.25
ENDIF

SELECTCASE ABL:(ARG:0):욕망
	CASE 0
		TIMES LOCAL:0, 0.40
	CASE 1
		TIMES LOCAL:0, 0.80
	CASE 2
		TIMES LOCAL:0, 1.60
	CASE 3
		TIMES LOCAL:0, 2.50
	CASE 4
		TIMES LOCAL:0, 4.00
	CASEELSE
		LOCAL:0 = LOCAL:0 * ((ABL:(ARG:0):욕망 - 5) * 2 + 60) / 10
ENDSELECT
RETURNF LOCAL:0

;-------------------------------------------------
;대응하는 감각 레벨에 의한 쾌락 소스에의 보정
;ARG:0=감각의 값
;ARG:1=현재의 쾌감 소스
;-------------------------------------------------
@CALC_SOURCE_SENSE_BASE(ARG:0, ARG:1)
#FUNCTION
LOCAL:0 = ARG:1
LOCAL:1 = ARG:1
SELECTCASE ARG:0
	CASE 0
		TIMES LOCAL:0, 0.6
	CASE 1
		TIMES LOCAL:0, 0.8
	CASE 2
		TIMES LOCAL:0, 1.0
	CASE 3
		TIMES LOCAL:0, 1.5
	CASE 4
		TIMES LOCAL:0, 2.0
	CASEELSE
		LOCAL:0 = LOCAL:0 * ((ARG:0 - 4) * 80 + 200) / 100
ENDSELECT
RETURNF LOCAL:0
;-------------------------------------------------
;욕정에 의한 쾌감량의 공통 보정 ARG:0=캐릭터 번호, ARG:1=욕정 상승의 기본치
;-------------------------------------------------
@CALC_SOURCE_SENSE_ESTRUS(ARG:0, ARG:1)
#FUNCTION
LOCAL:0 = ARG:1
IF PALAM:(ARG:0):욕정 < PALAMLV:1
	TIMES LOCAL:0, 0.30
ELSEIF PALAM:(ARG:0):욕정 < PALAMLV:2
	TIMES LOCAL:0, 0.40
ELSEIF PALAM:(ARG:0):욕정 < PALAMLV:3
	TIMES LOCAL:0, 0.60
ELSEIF PALAM:(ARG:0):욕정 < PALAMLV:4
	TIMES LOCAL:0, 0.80
ELSEIF PALAM:(ARG:0):욕정 < PALAMLV:5
	TIMES LOCAL:0, 1.00
ELSEIF PALAM:(ARG:0):욕정 < PALAMLV:6
	TIMES LOCAL:0, 1.05
ELSEIF PALAM:(ARG:0):욕정 < PALAMLV:7
	TIMES LOCAL:0, 1.10
ELSEIF PALAM:(ARG:0):욕정 < PALAMLV:8
	TIMES LOCAL:0, 1.20
ELSEIF PALAM:(ARG:0):욕정 < PALAMLV:9
	TIMES LOCAL:0, 1.30
ELSE
	TIMES LOCAL:0, 1.40
ENDIF
RETURNF LOCAL:0

;-------------------------------------------------
;분유상승량의 공통 보정 ARG:0=캐릭터 번호, ARG:1=분유상승의 기본치
;-------------------------------------------------
@CALC_SOURCE_MILK(ARG:0, ARG:1)
#FUNCTION
LOCAL:0 = ARG:1
SELECTCASE ABL:(ARG:0):분유
	CASE 0
		TIMES LOCAL:0, 1.00
	CASE 1
		TIMES LOCAL:0, 1.15
	CASE 2
		TIMES LOCAL:0, 1.30
	CASE 3
		TIMES LOCAL:0, 1.50
	CASE 4
		TIMES LOCAL:0, 2.0
	CASEELSE
		LOCAL:0 = LOCAL:0 * MIN(ABL:(ARG:0):분유 * 50, 1000) / 100
ENDSELECT
RETURNF LOCAL:0
