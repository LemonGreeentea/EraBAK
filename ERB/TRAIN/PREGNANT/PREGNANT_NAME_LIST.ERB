;-------------------------
;정액 맵을 작성
;하에아래에 추가해 나가는 것
;-------------------------
@CREATE_SPERM_MAP
SPERM_NAME_ARRAY:0 = 불명
;CALL ADD_SPERM("도둑")
;CALL ADD_SPERM("홉고블린")
;CALL ADD_SPERM("외래인")
;CALL ADD_SPERM("촉수")
;CALL ADD_SPERM("자경단")
;CALL ADD_SPERM("서큐버스")
;CALL ADD_SPERM(" 「실험동물」")
;CALL ADD_SPERM("개")
;CALL ADD_SPERM("돼지")
;CALL ADD_SPERM("말")
;CALL ADD_SPERM("약팔이")
;CALL ADD_SPERM("대금업자의 손님")
;CALL ADD_SPERM("최면술사")
;CALL ADD_SPERM("창관의 손님")
;CALL ADD_SPERM("병사")
;CALL ADD_SPERM("오니")
;CALL ADD_SPERM("들요괴")
;CALL ADD_SPERM("부랑자")
;CALL ADD_SPERM("바람둥이")
;CALL ADD_SPERM("산적")
;CALL ADD_SPERM("야쿠자")
;CALL ADD_SPERM("똘마니")
;CALL ADD_SPERM("건달")
;CALL ADD_SPERM("노예 상인")
;CALL ADD_SPERM("치한")
;CALL ADD_SPERM("아이")
;CALL ADD_SPERM("지주")
;CALL ADD_SPERM("불량배")
;CALL ADD_SPERM("지나가는 남자")
;CALL ADD_SPERM("의사")
;CALL ADD_SPERM("귀족")
;CALL ADD_SPERM("영지민")
;CALL ADD_SPERM("노인")
;CALL ADD_SPERM("악마")
;CALL ADD_SPERM("좀비")
;CALL ADD_SPERM("텐구")
;CALL ADD_SPERM("오크")
;CALL ADD_SPERM("AV남배우")
;CALL ADD_SPERM("카지노의 손님")
;CALL ADD_SPERM("광신도")

;-------------------------
;지정한 이름을 가지는 정액을 추가
;이중 등록 금지
;-------------------------
@ADD_SPERM(SPERMNAME)
#DIMS SPERMNAME
;등록이 끝난 상태라면 스르
SIF FINDELEMENT(SPERM_NAME_ARRAY, SPERMNAME, 0, SPERM_MAX_ADDRESS, 1) != -1
	RETURN 0
FOR LOCAL, 0, SPERM_MAX_ADDRESS
	SIF SPERM_NAME_ARRAY:LOCAL == ""
		GOTO FOUND
NEXT

THROW SPERM_NAME_ARRAY가 가득입니다

$FOUND

SPERM_NAME_ARRAY:LOCAL = %SPERMNAME%

RETURN 1

;-------------------------
;지정한 이름을 가지는 정액의 ID를 취득
;-------------------------
@GET_SPERM_ID(SPERMNAME)
#FUNCTION
#DIMS SPERMNAME
LOCAL = FINDELEMENT(SPERM_NAME_ARRAY, SPERMNAME, 0, SPERM_MAX_ADDRESS, 1)
IF LOCAL == -1
	FOR LOCAL, 0, SPERM_MAX_ADDRESS
		SIF SPERM_NAME_ARRAY:LOCAL == ""
			GOTO FOUND
	NEXT
	$FOUND
	SPERM_NAME_ARRAY:LOCAL = %SPERMNAME%
ENDIF
RETURNF LOCAL * -1

;-------------------------
;지정한 ID를 가지는 정액의 이름을 취득
;-------------------------
@GET_SPERM_NAME(SPERMID)
#FUNCTIONS
#DIM SPERMID
IF SPERMID > 0
	LOCAL = ID_TO_CHARA(SPERMID)
	SIF LOCAL == -1
		RETURNF "불명"
	RETURNF ANAME(LOCAL)
ENDIF
LOCALS = %SPERM_NAME_ARRAY:(SPERMID * -1)%
SIF LOCALS == ""
	RETURNF "불명"
RETURNF LOCALS

;-------------------------
;게임의 버젼이 올랐을 경우에, 정액 맵을 크린 하는 처리
;거리탐색이라든지 절대로（절대로）표기 흔들리게 해 올 것임에 틀림없기에.
;-------------------------
@CLEAN_SPERM_MAP()
FOR LOCAL, 1, SPERM_MAX_ADDRESS
	SIF SPERM_NAME_ARRAY:LOCAL == ""
		CONTINUE
	FOR LOCAL:1, 0, CHARANUM
		SIF CFLAG:(LOCAL:1):부친 * -1 == LOCAL
			GOTO FOUND
		FOR LOCAL:2, 0, PREGNANT_RECORD_MAX
			SIF PREGNANT_RECORD_FATHER:(LOCAL:1):(LOCAL:2) * -1 == LOCAL
				GOTO FOUND
		NEXT
		FOR LOCAL:2, 0, WOMB_RECORD_MAX
			SIF WOMB_SEMEN_ID:(LOCAL:1):(LOCAL:2) * -1 == LOCAL
				GOTO FOUND
		NEXT
	NEXT
	SPERM_NAME_ARRAY:LOCAL = ""
	$FOUND
NEXT


;-------------------------
;지정한 고정 캐릭터 사이에 형제·자매의 관계를 설정
;-------------------------
@SET_SIBLING_RELATION(ARG:0 = -1, ARG:1 = -1, ARG:2 = -1, ARG:3 = -1, ARG:4 = -1, ARG:5 = -1, ARG:6 = -1, ARG:7 = -1, ARG:8 = -1, ARG:9 = -1)
FOR LOCAL, 0, SPERM_MAX_ADDRESS
	IF SPERM_NAME_ARRAY:LOCAL == ""
		LOCAL:2 = LOCAL
		LOCAL --
		BREAK
	ENDIF
NEXT

SIF LOCAL == SPERM_MAX_ADDRESS
	THROW SPERM_NAME_ARRAY가 가득입니다

SPERM_NAME_ARRAY:(LOCAL:2) = 불명
BROTHER_SPERM_FLAG:(LOCAL:2) = 1
FOR LOCAL:1, 0, 10
	SIF ARG:(LOCAL:1) == -1
		BREAK
	SIF !IS_FIXED_CHARA(ARG:(LOCAL:1))
		THROW SET_SIBLING_RELATION에 건네줄 수 있는 것은 고정 캐릭터만입니다
	CFLAG:(ARG:(LOCAL:1)):부친 = LOCAL:2 * -1
	CFLAG:(ARG:(LOCAL:1)):모친 = LOCAL:2 * -1
NEXT

RETURN 1

@INIT_CHARA_SIBLING_RELATION()
CALL SET_SIBLING_RELATION(NAME_TO_CHARA("레밀리아"), NAME_TO_CHARA("플랑도르"))
CALL SET_SIBLING_RELATION(NAME_TO_CHARA("시즈하"), NAME_TO_CHARA("미노리코"))
CALL SET_SIBLING_RELATION(NAME_TO_CHARA("루나사"), NAME_TO_CHARA("리리카"), NAME_TO_CHARA("메를랑"))
CALL SET_SIBLING_RELATION(NAME_TO_CHARA("토요히메"), NAME_TO_CHARA("요리히메"))
CALL SET_SIBLING_RELATION(NAME_TO_CHARA("사토리"), NAME_TO_CHARA("코이시"))
CALL SET_SIBLING_RELATION(NAME_TO_CHARA("벤벤"), NAME_TO_CHARA("야츠하시"))
CALL SET_SIBLING_RELATION(NAME_TO_CHARA("무게츠"), NAME_TO_CHARA("겐게츠"))
CALL SET_SIBLING_RELATION(NAME_TO_CHARA("묘우렌"), NAME_TO_CHARA("뱌쿠렌"))
CALL SET_SIBLING_RELATION(NAME_TO_CHARA("시온 "), NAME_TO_CHARA("조온"))

